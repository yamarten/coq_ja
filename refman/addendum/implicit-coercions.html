

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Implicit Coercions &mdash; Coq 8.8.2 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansi.css" type="text/css" />
  <link rel="stylesheet" href="../_static/coqdoc.css" type="text/css" />
  <link rel="stylesheet" href="../_static/notations.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pre-text.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="Canonical Structures" href="canonical-structures.html" />
    <link rel="prev" title="Extended pattern matching" href="extended-pattern-matching.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Coq
          

          
          </a>

          
            
            
              <div class="version">
                8.8.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">索引</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-cmdindex.html">Command index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-tacindex.html">Tactic index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-optindex.html">Flags, options and tables index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-exnindex.html">Errors and warnings index</a></li>
</ul>
<p class="caption"><span class="caption-text">はじめに</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>
<p class="caption"><span class="caption-text">言語</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/gallina-specification-language.html">The Gallina specification language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/gallina-extensions.html">Extensions of <span class="smallcaps">Gallina</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/coq-library.html">The <span class="smallcaps">Coq</span> library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/cic.html">Calculus of Inductive Constructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/module-system.html">The Module System</a></li>
</ul>
<p class="caption"><span class="caption-text">証明エンジン</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/vernacular-commands.html">Vernacular commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/proof-handling.html">Proof handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/tactics.html">Tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ltac.html">The tactic language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/detailed-tactic-examples.html">Detailed examples of tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ssreflect-proof-language.html">The <span class="smallcaps">SSReflect</span> proof language</a></li>
</ul>
<p class="caption"><span class="caption-text">ユーザ拡張</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/syntax-extensions.html">Syntax extensions and interpretation scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/proof-schemes.html">Proof schemes</a></li>
</ul>
<p class="caption"><span class="caption-text">実用ツール</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coq-commands.html">The <span class="smallcaps">Coq</span> commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coqide.html"><span class="smallcaps">Coq</span> Integrated Development Environment</a></li>
</ul>
<p class="caption"><span class="caption-text">付録</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="extended-pattern-matching.html">Extended pattern matching</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implicit Coercions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-presentation">General Presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coercions">Coercions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#identity-coercions">Identity Coercions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inheritance-graph">Inheritance Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#declaring-coercions">Declaring Coercions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#displaying-available-coercions">Displaying Available Coercions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#activating-the-printing-of-coercions">Activating the Printing of Coercions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classes-as-records">Classes as Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coercions-and-sections">Coercions and Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coercions-and-modules">Coercions and Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coercion-at-function-application">Coercion at function application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coercion-to-a-type">Coercion to a type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coercion-to-a-function">Coercion to a function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="canonical-structures.html">Canonical Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-classes.html">Type Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="omega.html">Omega: a solver for quantifier-free problems in Presburger Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="micromega.html">Micromega: tactics for solving arithmetic goals over ordered rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="extraction.html">Extraction of programs in <span class="smallcaps">OCaml</span> and Haskell</a></li>
<li class="toctree-l1"><a class="reference internal" href="program.html">Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring.html">The ring and field tactic families</a></li>
<li class="toctree-l1"><a class="reference internal" href="nsatz.html">Nsatz: tactics for proving equalities in integral domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="generalized-rewriting.html">Generalized rewriting</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel-proof-processing.html">Asynchronous and Parallel Proof Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous-extensions.html">Miscellaneous extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="universe-polymorphism.html">Polymorphic Universes</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zebibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Coq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Implicit Coercions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/coq/coq/blob/master/doc/sphinx/addendum/implicit-coercions.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="math-preamble math notranslate">
\[\begin{split}\newcommand{\alors}{\textsf{then}}
\newcommand{\alter}{\textsf{alter}}
\newcommand{\as}{\kw{as}}
\newcommand{\Assum}[3]{\kw{Assum}(#1)(#2:#3)}
\newcommand{\bool}{\textsf{bool}}
\newcommand{\case}{\kw{case}}
\newcommand{\conc}{\textsf{conc}}
\newcommand{\cons}{\textsf{cons}}
\newcommand{\consf}{\textsf{consf}}
\newcommand{\conshl}{\textsf{cons\_hl}}
\newcommand{\Def}[4]{\kw{Def}(#1)(#2:=#3:#4)}
\newcommand{\emptyf}{\textsf{emptyf}}
\newcommand{\End}{\kw{End}}
\newcommand{\kwend}{\kw{end}}
\newcommand{\EqSt}{\textsf{EqSt}}
\newcommand{\even}{\textsf{even}}
\newcommand{\evenO}{\textsf{even}_\textsf{O}}
\newcommand{\evenS}{\textsf{even}_\textsf{S}}
\newcommand{\false}{\textsf{false}}
\newcommand{\filter}{\textsf{filter}}
\newcommand{\Fix}{\kw{Fix}}
\newcommand{\fix}{\kw{fix}}
\newcommand{\for}{\textsf{for}}
\newcommand{\forest}{\textsf{forest}}
\newcommand{\from}{\textsf{from}}
\newcommand{\Functor}{\kw{Functor}}
\newcommand{\haslength}{\textsf{has\_length}}
\newcommand{\hd}{\textsf{hd}}
\newcommand{\ident}{\textsf{ident}}
\newcommand{\In}{\kw{in}}
\newcommand{\Ind}[4]{\kw{Ind}[#2](#3:=#4)}
\newcommand{\ind}[3]{\kw{Ind}~[#1]\left(#2\mathrm{~:=~}#3\right)}
\newcommand{\Indp}[5]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)}
\newcommand{\Indpstr}[6]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)/{#6}}
\newcommand{\injective}{\kw{injective}}
\newcommand{\kw}[1]{\textsf{#1}}
\newcommand{\lb}{\lambda}
\newcommand{\length}{\textsf{length}}
\newcommand{\letin}[3]{\kw{let}~#1:=#2~\kw{in}~#3}
\newcommand{\List}{\textsf{list}}
\newcommand{\lra}{\longrightarrow}
\newcommand{\Match}{\kw{match}}
\newcommand{\Mod}[3]{{\kw{Mod}}({#1}:{#2}\,\zeroone{:={#3}})}
\newcommand{\ModA}[2]{{\kw{ModA}}({#1}=={#2})}
\newcommand{\ModS}[2]{{\kw{Mod}}({#1}:{#2})}
\newcommand{\ModType}[2]{{\kw{ModType}}({#1}:={#2})}
\newcommand{\mto}{.\;}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\nat}{\textsf{nat}}
\newcommand{\Nil}{\textsf{nil}}
\newcommand{\nilhl}{\textsf{nil\_hl}}
\newcommand{\nO}{\textsf{O}}
\newcommand{\node}{\textsf{node}}
\newcommand{\nS}{\textsf{S}}
\newcommand{\odd}{\textsf{odd}}
\newcommand{\oddS}{\textsf{odd}_\textsf{S}}
\newcommand{\ovl}[1]{\overline{#1}}
\newcommand{\Pair}{\textsf{pair}}
\newcommand{\Prod}{\textsf{prod}}
\newcommand{\Prop}{\textsf{Prop}}
\newcommand{\return}{\kw{return}}
\newcommand{\Set}{\textsf{Set}}
\newcommand{\si}{\textsf{if}}
\newcommand{\sinon}{\textsf{else}}
\newcommand{\Sort}{\cal S}
\newcommand{\Str}{\textsf{Stream}}
\newcommand{\Struct}{\kw{Struct}}
\newcommand{\subst}[3]{#1\{#2/#3\}}
\newcommand{\tl}{\textsf{tl}}
\newcommand{\tree}{\textsf{tree}}
\newcommand{\true}{\textsf{true}}
\newcommand{\Type}{\textsf{Type}}
\newcommand{\unfold}{\textsf{unfold}}
\newcommand{\WEV}[3]{\mbox{$#1[] \vdash #2 \lra  #3$}}
\newcommand{\WEVT}[3]{\mbox{$#1[] \vdash #2 \lra$}\\ \mbox{$ #3$}}
\newcommand{\WF}[2]{{\cal W\!F}(#1)[#2]}
\newcommand{\WFE}[1]{\WF{E}{#1}}
\newcommand{\WFT}[2]{#1[] \vdash {\cal W\!F}(#2)}
\newcommand{\WFTWOLINES}[2]{{\cal W\!F}\begin{array}{l}(#1)\\\mbox{}[{#2}]\end{array}}
\newcommand{\with}{\kw{with}}
\newcommand{\WS}[3]{#1[] \vdash #2 &lt;: #3}
\newcommand{\WSE}[2]{\WS{E}{#1}{#2}}
\newcommand{\WT}[4]{#1[#2] \vdash #3 : #4}
\newcommand{\WTE}[3]{\WT{E}{#1}{#2}{#3}}
\newcommand{\WTEG}[2]{\WTE{\Gamma}{#1}{#2}}
\newcommand{\WTM}[3]{\WT{#1}{}{#2}{#3}}
\newcommand{\zeroone}[1]{[{#1}]}
\newcommand{\zeros}{\textsf{zeros}}
\end{split}\]</div>
<div class="section" id="implicit-coercions">
<span id="implicitcoercions"></span><h1>Implicit Coercions<a class="headerlink" href="#implicit-coercions" title="このヘッドラインへのパーマリンク">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Amokrane Saïbi</td>
</tr>
</tbody>
</table>
<div class="section" id="general-presentation">
<h2>General Presentation<a class="headerlink" href="#general-presentation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>This section describes the inheritance mechanism of <span class="smallcaps">Coq</span>. In <span class="smallcaps">Coq</span> with
inheritance, we are not interested in adding any expressive power to
our theory, but only convenience. Given a term, possibly not typable,
we are interested in the problem of determining if it can be well
typed modulo insertion of appropriate coercions. We allow to write:</p>
<blockquote>
<div><ul class="simple">
<li><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">a</span></span></code> where <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span><span class="operator"><span class="pre">:(</span></span><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span><span class="name"><span class="pre">B</span></span><span class="operator"><span class="pre">)</span></span></code> and <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">a</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A'</span></span></code> when <code class="docutils literal notranslate"><span class="pre">A'</span></code> can
be seen in some sense as a subtype of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</li>
<li><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span></code> when <code class="docutils literal notranslate"><span class="pre">A</span></code> is not a type, but can be seen in
a certain sense as a type: set, group, category etc.</li>
<li><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">a</span></span></code> when <code class="docutils literal notranslate"><span class="pre">f</span></code> is not a function, but can be seen in a certain sense
as a function: bijection, functor, any structure morphism etc.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A class with <cite>n</cite> parameters is any defined name with a type
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Aₙ</span></span><span class="operator"><span class="pre">),</span></span><span class="name"><span class="pre">s</span></span></code> where <code class="docutils literal notranslate"><span class="pre">s</span></code> is a sort.  Thus a class with
parameters is considered as a single class and not as a family of
classes.  An object of a class <code class="docutils literal notranslate"><span class="pre">C</span></code> is any term of type <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">t₁</span></span> <span class="operator"><span class="pre">..</span></span> <span class="name"><span class="pre">tₙ</span></span></code>.
In addition to these user-defined classes, we have two built-in classes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Sortclass</span></code>, the class of sorts; its objects are the terms whose type is a
sort (e.g. <code class="code Coq docutils literal notranslate"><span class="keyword type"><span class="pre">Prop</span></span></code> or <code class="code Coq docutils literal notranslate"><span class="keyword type"><span class="pre">Type</span></span></code>).</li>
<li><code class="docutils literal notranslate"><span class="pre">Funclass</span></code>, the class of functions; its objects are all the terms with a functional
type, i.e. of form <code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span><span class="name"><span class="pre">B</span></span></code>.</li>
</ul>
</div></blockquote>
<p>Formally, the syntax of a classes is defined as:</p>
<pre>
<strong id="grammar-token-class">class</strong> ::=  qualid
           | <code class="xref docutils literal notranslate"><span class="pre">Sortclass</span></code>
           | <code class="xref docutils literal notranslate"><span class="pre">Funclass</span></code>
</pre>
</div>
<div class="section" id="coercions">
<h2>Coercions<a class="headerlink" href="#coercions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A name <code class="docutils literal notranslate"><span class="pre">f</span></code> can be declared as a coercion between a source user-defined class
<code class="docutils literal notranslate"><span class="pre">C</span></code> with <cite>n</cite> parameters and a target class <code class="docutils literal notranslate"><span class="pre">D</span></code> if one of these
conditions holds:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">D</span></code> is a user-defined class, then the type of <code class="docutils literal notranslate"><span class="pre">f</span></code> must have the form
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Aₙ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">),</span></span> <span class="name"><span class="pre">D</span></span> <span class="name"><span class="pre">u₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">uₘ</span></span></code> where <cite>m</cite>
is the number of parameters of <code class="docutils literal notranslate"><span class="pre">D</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">D</span></code> is <code class="docutils literal notranslate"><span class="pre">Funclass</span></code>, then the type of <code class="docutils literal notranslate"><span class="pre">f</span></code> must have the form
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Aₙ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">),</span></span> <span class="name"><span class="pre">B</span></span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">D</span></code> is <code class="docutils literal notranslate"><span class="pre">Sortclass</span></code>, then the type of <code class="docutils literal notranslate"><span class="pre">f</span></code> must have the form
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Aₙ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">),</span></span> <span class="name"><span class="pre">s</span></span></code> with <code class="docutils literal notranslate"><span class="pre">s</span></code> a sort.</li>
</ul>
</div></blockquote>
<p>We then write <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="operator"><span class="pre">:</span></span> <span class="name"><span class="pre">C</span></span> <span class="operator"><span class="pre">&gt;-&gt;</span></span> <span class="name"><span class="pre">D</span></span></code>. The restriction on the type
of coercions is called <em>the uniform inheritance condition</em>.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">The built-in class <code class="docutils literal notranslate"><span class="pre">Sortclass</span></code> can be used as a source class, but
the built-in class <code class="docutils literal notranslate"><span class="pre">Funclass</span></code> cannot.</p>
</div>
<p>To coerce an object <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">t</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₙ</span></span></code> of <code class="docutils literal notranslate"><span class="pre">C</span></code> towards <code class="docutils literal notranslate"><span class="pre">D</span></code>, we have to
apply the coercion <code class="docutils literal notranslate"><span class="pre">f</span></code> to it; the obtained term <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₙ</span></span> <span class="name"><span class="pre">t</span></span></code> is
then an object of <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
</div>
<div class="section" id="identity-coercions">
<h2>Identity Coercions<a class="headerlink" href="#identity-coercions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Identity coercions are special cases of coercions used to go around
the uniform inheritance condition. Let <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code> be two classes
with respectively <cite>n</cite> and <cite>m</cite> parameters and
<code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span><span class="operator"><span class="pre">:</span></span><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₖ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">u₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">uₙ</span></span><span class="operator"><span class="pre">),</span></span> <span class="name"><span class="pre">D</span></span> <span class="name"><span class="pre">v₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">vₘ</span></span></code> a function which
does not verify the uniform inheritance condition. To declare <code class="docutils literal notranslate"><span class="pre">f</span></code> as
coercion, one has first to declare a subclass <code class="docutils literal notranslate"><span class="pre">C'</span></code> of <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p>
<blockquote>
<div><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">C'</span></span> <span class="operator"><span class="pre">:=</span></span> <span class="keyword"><span class="pre">fun</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₖ</span></span><span class="operator"><span class="pre">)</span></span> <span class="operator"><span class="pre">=&gt;</span></span> <span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">u₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">uₙ</span></span></code></div></blockquote>
<p>We then define an <em>identity coercion</em> between <code class="docutils literal notranslate"><span class="pre">C'</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p>
<blockquote>
<div><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">Id_C'_C</span></span>&#160; <span class="operator"><span class="pre">:=</span></span> <span class="keyword"><span class="pre">fun</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₖ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C'</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">)</span></span> <span class="operator"><span class="pre">=&gt;</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">u₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">uₙ</span></span><span class="operator"><span class="pre">)</span></span></code></div></blockquote>
<p>We can now declare <code class="docutils literal notranslate"><span class="pre">f</span></code> as coercion from <code class="docutils literal notranslate"><span class="pre">C'</span></code> to <code class="docutils literal notranslate"><span class="pre">D</span></code>, since we can
&quot;cast&quot; its type as
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₖ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C'</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₖ</span></span><span class="operator"><span class="pre">),</span></span><span class="name"><span class="pre">D</span></span> <span class="name"><span class="pre">v₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">vₘ</span></span></code>.</p>
<p>The identity coercions have a special status: to coerce an object
<code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">t</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C'</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₖ</span></span></code>
of <code class="docutils literal notranslate"><span class="pre">C'</span></code> towards <code class="docutils literal notranslate"><span class="pre">C</span></code>, we do not have to insert explicitly <code class="docutils literal notranslate"><span class="pre">Id_C'_C</span></code>
since <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">Id_C'_C</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₖ</span></span> <span class="name"><span class="pre">t</span></span></code> is convertible with <code class="docutils literal notranslate"><span class="pre">t</span></code>.  However we
&quot;rewrite&quot; the type of <code class="docutils literal notranslate"><span class="pre">t</span></code> to become an object of <code class="docutils literal notranslate"><span class="pre">C</span></code>; in this case,
it becomes <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">uₙ'</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">uₖ'</span></span></code> where each <code class="docutils literal notranslate"><span class="pre">uᵢ'</span></code> is the result of the
substitution in <code class="docutils literal notranslate"><span class="pre">uᵢ</span></code> of the variables <code class="docutils literal notranslate"><span class="pre">xⱼ</span></code> by <code class="docutils literal notranslate"><span class="pre">tⱼ</span></code>.</p>
</div>
<div class="section" id="inheritance-graph">
<h2>Inheritance Graph<a class="headerlink" href="#inheritance-graph" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Coercions form an inheritance graph with classes as nodes.  We call
<em>coercion path</em> an ordered list of coercions between two nodes of
the graph.  A class <code class="docutils literal notranslate"><span class="pre">C</span></code> is said to be a subclass of <code class="docutils literal notranslate"><span class="pre">D</span></code> if there is a
coercion path in the graph from <code class="docutils literal notranslate"><span class="pre">C</span></code> to <code class="docutils literal notranslate"><span class="pre">D</span></code>; we also say that <code class="docutils literal notranslate"><span class="pre">C</span></code>
inherits from <code class="docutils literal notranslate"><span class="pre">D</span></code>. Our mechanism supports multiple inheritance since a
class may inherit from several classes, contrary to simple inheritance
where a class inherits from at most one class.  However there must be
at most one path between two classes. If this is not the case, only
the <em>oldest</em> one is valid and the others are ignored. So the order
of declaration of coercions is important.</p>
<p>We extend notations for coercions to coercion paths. For instance
<code class="code Coq docutils literal notranslate"><span class="operator"><span class="pre">[</span></span><span class="name"><span class="pre">f₁</span></span><span class="operator"><span class="pre">;..;</span></span><span class="name"><span class="pre">fₖ</span></span><span class="operator"><span class="pre">]</span></span> <span class="operator"><span class="pre">:</span></span> <span class="name"><span class="pre">C</span></span> <span class="operator"><span class="pre">&gt;-&gt;</span></span> <span class="name"><span class="pre">D</span></span></code> is the coercion path composed
by the coercions <code class="docutils literal notranslate"><span class="pre">f₁..fₖ</span></code>.  The application of a coercion path to a
term consists of the successive application of its coercions.</p>
</div>
<div class="section" id="declaring-coercions">
<h2>Declaring Coercions<a class="headerlink" href="#declaring-coercions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="cmd">
<dt id="coq:cmd.coercion">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>:</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <span>&gt;-&gt;</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a></span></code><a class="headerlink" href="#coq:cmd.coercion" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Declares the construction denoted by <cite>qualid</cite> as a coercion between
the two given classes.</p>
<dl class="exn">
<dt id="coq:exn.qualid-not-declared">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>not</span> <span>declared.</span></span></code><a class="headerlink" href="#coq:exn.qualid-not-declared" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.qualid-is-already-a-coercion">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>is</span> <span>already</span> <span>a</span> <span>coercion.</span></span></code><a class="headerlink" href="#coq:exn.qualid-is-already-a-coercion" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.funclass-cannot-be-a-source-class">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><span>Funclass</span> <span>cannot</span> <span>be</span> <span>a</span> <span>source</span> <span>class.</span></span></code><a class="headerlink" href="#coq:exn.funclass-cannot-be-a-source-class" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.qualid-is-not-a-function">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>is</span> <span>not</span> <span>a</span> <span>function.</span></span></code><a class="headerlink" href="#coq:exn.qualid-is-not-a-function" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.cannot-find-the-source-class-of-qualid">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><span>Cannot</span> <span>find</span> <span>the</span> <span>source</span> <span>class</span> <span>of</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a><span>.</span></span></code><a class="headerlink" href="#coq:exn.cannot-find-the-source-class-of-qualid" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.cannot-recognize-class-as-a-source-class-of-qualid">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><span>Cannot</span> <span>recognize</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <span>as</span> <span>a</span> <span>source</span> <span>class</span> <span>of</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a><span>.</span></span></code><a class="headerlink" href="#coq:exn.cannot-recognize-class-as-a-source-class-of-qualid" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.qualid-does-not-respect-the-uniform-inheritance-condition">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>does</span> <span>not</span> <span>respect</span> <span>the</span> <span>uniform</span> <span>inheritance</span> <span>condition.</span></span></code><a class="headerlink" href="#coq:exn.qualid-does-not-respect-the-uniform-inheritance-condition" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="exn">
<dt id="coq:exn.found-target-class-instead-of">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><span>Found</span> <span>target</span> <span>class</span> <span>...</span> <span>instead</span> <span>of</span> <span>...</span></span></code><a class="headerlink" href="#coq:exn.found-target-class-instead-of" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="warn">
<dt id="coq:warn.ambiguous-path">
<em class="property"><span class="sigannot">Warning</span></em> <code class="descname"><span class="notation"><span>Ambiguous</span> <span>path.</span></span></code><a class="headerlink" href="#coq:warn.ambiguous-path" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>When the coercion <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><code class="xref std std-token docutils literal notranslate"><span class="pre">qualid</span></code></a> is added to the inheritance graph,
invalid coercion paths are ignored; they are signaled by a warning
displaying these paths of the form <code class="code Coq docutils literal notranslate"><span class="operator"><span class="pre">[</span></span><span class="name"><span class="pre">f₁</span></span><span class="operator"><span class="pre">;..;</span></span><span class="name"><span class="pre">fₙ</span></span><span class="operator"><span class="pre">]</span></span> <span class="operator"><span class="pre">:</span></span> <span class="name"><span class="pre">C</span></span> <span class="operator"><span class="pre">&gt;-&gt;</span></span> <span class="name"><span class="pre">D</span></span></code>.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Local</span> <span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a> <span>:</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <span>&gt;-&gt;</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a></span></code></dt>
<dd><p>Declares the construction denoted by <cite>qualid</cite> as a coercion local to
the current section.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span></code></dt>
<dd><p>This defines <cite>ident</cite> just like <code class="docutils literal notranslate"><span class="pre">Definition</span></code> <cite>ident</cite> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>term</cite>,
and then declares <cite>ident</cite> as a coercion between it source and its target.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a> <span>:</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-type"><span class="hole">type</span></a></span></code></dt>
<dd><p>This defines <cite>ident</cite> just like <code class="docutils literal notranslate"><span class="pre">Definition</span></code> <cite>ident</cite> : <cite>type</cite> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>term</cite>,
and then declares <cite>ident</cite> as a coercion between it source and its target.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Local</span> <span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span></code></dt>
<dd><p>This defines <cite>ident</cite> just like <code class="docutils literal notranslate"><span class="pre">Let</span></code> <cite>ident</cite> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>term</cite>,
and then declares <cite>ident</cite> as a coercion between it source and its target.</p>
</dd></dl>

</dd></dl>

<p>Assumptions can be declared as coercions at declaration time.
This extends the grammar of assumptions from
Figure <a class="reference internal" href="../language/gallina-specification-language.html#vernacular"><span class="std std-ref">The Vernacular</span></a> as follows:</p>
<pre>
<strong id="grammar-token-assumption">assumption   </strong> ::=  assumption_keyword assums .
<strong id="grammar-token-assums">assums       </strong> ::=  simple_assums
                   | (simple_assums) ... (simple_assums)
<strong id="grammar-token-simple_assums">simple_assums</strong> ::=  ident ... ident :[&gt;] term
</pre>
<p>If the extra <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> is present before the type of some assumptions, these
assumptions are declared as coercions.</p>
<p>Similarly, constructors of inductive types can be declared as coercions at
definition time of the inductive type. This extends and modifies the
grammar of inductive types from Figure <a class="reference internal" href="../language/gallina-specification-language.html#vernacular"><span class="std std-ref">The Vernacular</span></a> as follows:</p>
<pre>
<strong id="grammar-token-inductive">inductive  </strong> ::=  <code class="xref docutils literal notranslate"><span class="pre">Inductive</span></code> ind_body <code class="xref docutils literal notranslate"><span class="pre">with</span></code> ... <code class="xref docutils literal notranslate"><span class="pre">with</span></code> ind_body
                 | <code class="xref docutils literal notranslate"><span class="pre">CoInductive</span></code> ind_body <code class="xref docutils literal notranslate"><span class="pre">with</span></code> ... <code class="xref docutils literal notranslate"><span class="pre">with</span></code> ind_body
<strong id="grammar-token-ind_body">ind_body   </strong> ::=  ident [binders] : term := [[|] constructor | ... | constructor]
<strong id="grammar-token-constructor">constructor</strong> ::=  ident [binders] [:[&gt;] term]
</pre>
<p>Especially, if the extra <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> is present in a constructor
declaration, this constructor is declared as a coercion.</p>
<dl class="cmd">
<dt id="coq:cmd.identity-coercion">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Identity</span> <span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <span>&gt;-&gt;</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a></span></code><a class="headerlink" href="#coq:cmd.identity-coercion" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">C</span></code> is the source <cite>class</cite> and <code class="docutils literal notranslate"><span class="pre">D</span></code> the destination, we check
that <code class="docutils literal notranslate"><span class="pre">C</span></code> is a constant with a body of the form
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">fun</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₙ</span></span><span class="operator"><span class="pre">)</span></span> <span class="operator"><span class="pre">=&gt;</span></span> <span class="name"><span class="pre">D</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₘ</span></span></code> where <cite>m</cite> is the
number of parameters of <code class="docutils literal notranslate"><span class="pre">D</span></code>.  Then we define an identity
function with type <code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="operator"><span class="pre">(</span></span><span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">T₁</span></span><span class="operator"><span class="pre">)..(</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">Tₙ</span></span><span class="operator"><span class="pre">)(</span></span><span class="name"><span class="pre">y</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">C</span></span> <span class="name"><span class="pre">x₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">xₙ</span></span><span class="operator"><span class="pre">),</span></span><span class="name"><span class="pre">D</span></span> <span class="name"><span class="pre">t₁</span></span><span class="operator"><span class="pre">..</span></span><span class="name"><span class="pre">tₘ</span></span></code>,
and we declare it as an identity coercion between <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<dl class="exn">
<dt id="coq:exn.class-must-be-a-transparent-constant">
<em class="property"><span class="sigannot">Error</span></em> <code class="descname"><span class="notation"><a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <span>must</span> <span>be</span> <span>a</span> <span>transparent</span> <span>constant.</span></span></code><a class="headerlink" href="#coq:exn.class-must-be-a-transparent-constant" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Local</span> <span>Identity</span> <span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>&gt;-&gt;</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span></code></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">Identity</span> <span class="pre">Coercion</span></code> but locally to the current section.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>SubClass</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-type"><span class="hole">type</span></a></span></code></dt>
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>:name:</span> <span>SubClass</span></span></code></dt>
<dd><p>If <cite>type</cite> is a class <cite>ident'</cite> applied to some arguments then
<cite>ident</cite> is defined and an identity coercion of name
<cite>Id_ident_ident'</cite> is
declared. Otherwise said, this is an abbreviation for</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Definition</span></code> <cite>ident</cite> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>type</cite>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Identity</span> <span class="pre">Coercion</span></code> <cite>Id_ident_ident'</cite> : <cite>ident</cite> <code class="docutils literal notranslate"><span class="pre">&gt;-&gt;</span></code> <cite>ident'</cite>.</p>
</div></blockquote>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Local</span> <span>SubClass</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-type"><span class="hole">type</span></a></span></code></dt>
<dd><p>Same as before but locally to the current section.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="displaying-available-coercions">
<h2>Displaying Available Coercions<a class="headerlink" href="#displaying-available-coercions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="cmd">
<dt id="coq:cmd.print-classes">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Print</span> <span>Classes</span></span></code><a class="headerlink" href="#coq:cmd.print-classes" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Print the list of declared classes in the current context.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.print-coercions">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Print</span> <span>Coercions</span></span></code><a class="headerlink" href="#coq:cmd.print-coercions" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Print the list of declared coercions in the current context.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.print-graph">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Print</span> <span>Graph</span></span></code><a class="headerlink" href="#coq:cmd.print-graph" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Print the list of valid coercion paths in the current context.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.print-coercion-paths">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Print</span> <span>Coercion</span> <span>Paths</span> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a> <a class="reference internal" href="#grammar-token-class"><span class="hole">class</span></a></span></code><a class="headerlink" href="#coq:cmd.print-coercion-paths" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Print the list of valid coercion paths between the two given classes.</p>
</dd></dl>

</div>
<div class="section" id="activating-the-printing-of-coercions">
<h2>Activating the Printing of Coercions<a class="headerlink" href="#activating-the-printing-of-coercions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="flag">
<dt id="coq:flag.printing-coercions">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Printing</span> <span>Coercions</span></span></code><a class="headerlink" href="#coq:flag.printing-coercions" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>When on, this option forces all the coercions to be printed.
By default, coercions are not printed.</p>
</dd></dl>

<dl class="table">
<dt id="coq:table.printing-coercion">
<em class="property"><span class="sigannot">Table</span></em> <code class="descname"><span class="notation"><span>Printing</span> <span>Coercion</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-qualid"><span class="hole">qualid</span></a></span></code><a class="headerlink" href="#coq:table.printing-coercion" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Specifies a set of qualids for which coercions are always displayed.  Use the
<a class="reference internal" href="../proof-engine/vernacular-commands.html#coq:cmd.add-table" title="Add &#64;table"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Add</span> <span class="pre">&#64;table</span></code></a> and <a class="reference internal" href="../proof-engine/vernacular-commands.html#coq:cmd.remove-table" title="Remove &#64;table"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Remove</span> <span class="pre">&#64;table</span></code></a> commands to update the set of qualids.</p>
</dd></dl>

</div>
<div class="section" id="classes-as-records">
<span id="coercions-classes-as-records"></span><h2>Classes as Records<a class="headerlink" href="#classes-as-records" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>We allow the definition of <em>Structures with Inheritance</em> (or classes as records)
by extending the existing <a class="reference internal" href="../language/gallina-extensions.html#coq:cmd.record" title="Record"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Record</span></code></a> macro. Its new syntax is:</p>
<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Record</span> <span class="repeat-wrapper"><span class="repeat"><span>&gt;</span></span><span class="notation-sup">?</span></span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-sort"><span class="hole">sort</span></a> <span>:=</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">?</span></span> <span class="curlies">{ <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span><span class="repeat-wrapper"><span class="repeat"><span>&gt;</span></span><span class="notation-sup">?</span></span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span><span class="notation-sup">+</span><span class="notation-sub">;</span></span> }</span></span></code></dt>
<dd><p>The first identifier <cite>ident</cite> is the name of the defined record and
<cite>sort</cite> is its type. The optional identifier after <code class="docutils literal notranslate"><span class="pre">:=</span></code> is the name
of the constuctor (it will be <code class="docutils literal notranslate"><span class="pre">Build_</span></code><cite>ident</cite> if not given).
The other identifiers are the names of the fields, and the <cite>term</cite>
are their respective types. If <code class="docutils literal notranslate"><span class="pre">:&gt;</span></code> is used instead of <code class="docutils literal notranslate"><span class="pre">:</span></code> in
the declaration of a field, then the name of this field is automatically
declared as a coercion from the record name to the class of this
field type. Remark that the fields always verify the uniform
inheritance condition. If the optional <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> is given before the
record name, then the constructor name is automatically declared as
a coercion from the class of the last field type to the record name
(this may fail if the uniform inheritance condition is not
satisfied).</p>
</dd></dl>

<dl class="cmdv">
<dt id="coq:cmdv.structure">
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Structure</span> <span class="repeat-wrapper"><span class="repeat"><span>&gt;</span></span><span class="notation-sup">?</span></span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-sort"><span class="hole">sort</span></a> <span>:=</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">?</span></span> <span class="curlies">{ <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span><span class="repeat-wrapper"><span class="repeat"><span>&gt;</span></span><span class="notation-sup">?</span></span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span><span class="notation-sup">+</span><span class="notation-sub">;</span></span> }</span></span></code><a class="headerlink" href="#coq:cmdv.structure" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This is a synonym of <a class="reference internal" href="../language/gallina-extensions.html#coq:cmd.record" title="Record"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Record</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="coercions-and-sections">
<h2>Coercions and Sections<a class="headerlink" href="#coercions-and-sections" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The inheritance mechanism is compatible with the section
mechanism. The global classes and coercions defined inside a section
are redefined after its closing, using their new value and new
type. The classes and coercions which are local to the section are
simply forgotten.
Coercions with a local source class or a local target class, and
coercions which do not verify the uniform inheritance condition any longer
are also forgotten.</p>
</div>
<div class="section" id="coercions-and-modules">
<h2>Coercions and Modules<a class="headerlink" href="#coercions-and-modules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="flag">
<dt id="coq:flag.automatic-coercions-import">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Automatic</span> <span>Coercions</span> <span>Import</span></span></code><a class="headerlink" href="#coq:flag.automatic-coercions-import" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Since <span class="smallcaps">Coq</span> version 8.3, the coercions present in a module are activated
only when the module is explicitly imported. Formerly, the coercions
were activated as soon as the module was required, whether it was
imported or not.</p>
<p>This option makes it possible to recover the behavior of the versions of
<span class="smallcaps">Coq</span> prior to 8.3.</p>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>There are three situations:</p>
<div class="section" id="coercion-at-function-application">
<h3>Coercion at function application<a class="headerlink" href="#coercion-at-function-application" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">a</span></span></code> is ill-typed where <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span><span class="operator"><span class="pre">:</span></span><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span><span class="name"><span class="pre">B</span></span></code> and <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">a</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A'</span></span></code>. If there is a
coercion path between <code class="docutils literal notranslate"><span class="pre">A'</span></code> and <code class="docutils literal notranslate"><span class="pre">A</span></code>, then <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">a</span></span></code> is transformed into
<code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">f</span></span> <span class="name"><span class="pre">a'</span></span></code> where <code class="docutils literal notranslate"><span class="pre">a'</span></code> is the result of the application of this
coercion path to <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>We first give an example of coercion between atomic inductive types</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">bool_in_nat</span><span> (</span><span class="coqdoc-var">b</span><span>:</span><span class="coqdoc-var">bool</span><span>) := </span><span class="coqdoc-keyword">if</span><span> </span><span class="coqdoc-var">b</span><span> </span><span class="coqdoc-keyword">then</span><span> 0 </span><span class="coqdoc-keyword">else</span><span> 1.</span></dt>
<dd><span class="first last">bool_in_nat is defined</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">bool_in_nat</span><span> : </span><span class="coqdoc-var">bool</span><span> &gt;-&gt; </span><span class="coqdoc-var">nat</span><span>.</span></dt>
<dd><span class="first last">bool_in_nat is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (0 = </span><span class="coqdoc-var">true</span><span>).</span></dt>
<dd><span class="first">0</span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Prop</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (0 = </span><span class="coqdoc-var">true</span><span>).</span></dt>
<dd><span class="first">0</span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool_in_nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Prop</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">Note that <code class="docutils literal notranslate"><span class="pre">Check</span> <span class="pre">true=O</span></code> would fail. This is &quot;normal&quot; behavior of
coercions. To validate <code class="docutils literal notranslate"><span class="pre">true=O</span></code>, the coercion is searched from
<code class="docutils literal notranslate"><span class="pre">nat</span></code> to <code class="docutils literal notranslate"><span class="pre">bool</span></code>. There is none.</p>
</div>
<p>We give an example of coercion between classes with parameters.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Parameters</span><span> (</span><span class="coqdoc-var">C</span><span> : </span><span class="coqdoc-var">nat</span><span> -&gt; </span><span class="coqdoc-keyword">Set</span><span>) (</span><span class="coqdoc-var">D</span><span> : </span><span class="coqdoc-var">nat</span><span> -&gt; </span><span class="coqdoc-var">bool</span><span> -&gt; </span><span class="coqdoc-keyword">Set</span><span>) (</span><span class="coqdoc-var">E</span><span> : </span><span class="coqdoc-var">bool</span><span> -&gt; </span><span class="coqdoc-keyword">Set</span><span>).</span></dt>
<dd><span class="first last">C is declared
D is declared
E is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">f</span><span> : </span><span class="coqdoc-keyword">forall</span><span> </span><span class="coqdoc-var">n</span><span>:</span><span class="coqdoc-var">nat</span><span>, </span><span class="coqdoc-var">C</span><span> </span><span class="coqdoc-var">n</span><span> -&gt; </span><span class="coqdoc-var">D</span><span> (</span><span class="coqdoc-var">S</span><span> </span><span class="coqdoc-var">n</span><span>) </span><span class="coqdoc-var">true</span><span>.</span></dt>
<dd><span class="first last">f is declared</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">f</span><span> : </span><span class="coqdoc-var">C</span><span> &gt;-&gt; </span><span class="coqdoc-var">D</span><span>.</span></dt>
<dd><span class="first last">f is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">g</span><span> : </span><span class="coqdoc-keyword">forall</span><span> (</span><span class="coqdoc-var">n</span><span>:</span><span class="coqdoc-var">nat</span><span>) (</span><span class="coqdoc-var">b</span><span>:</span><span class="coqdoc-var">bool</span><span>), </span><span class="coqdoc-var">D</span><span> </span><span class="coqdoc-var">n</span><span> </span><span class="coqdoc-var">b</span><span> -&gt; </span><span class="coqdoc-var">E</span><span> </span><span class="coqdoc-var">b</span><span>.</span></dt>
<dd><span class="first last">g is declared</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">g</span><span> : </span><span class="coqdoc-var">D</span><span> &gt;-&gt; </span><span class="coqdoc-var">E</span><span>.</span></dt>
<dd><span class="first last">g is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">c</span><span> : </span><span class="coqdoc-var">C</span><span> 0.</span></dt>
<dd><span class="first last">c is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">T</span><span> : </span><span class="coqdoc-var">E</span><span> </span><span class="coqdoc-var">true</span><span> -&gt; </span><span class="coqdoc-var">nat</span><span>.</span></dt>
<dd><span class="first last">T is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">T</span><span> </span><span class="coqdoc-var">c</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">T</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">c</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">T</span><span> </span><span class="coqdoc-var">c</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">T</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">f</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0 </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">c</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">))
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>We give now an example using identity coercions.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">D'</span><span> (</span><span class="coqdoc-var">b</span><span>:</span><span class="coqdoc-var">bool</span><span>) := </span><span class="coqdoc-var">D</span><span> 1 </span><span class="coqdoc-var">b</span><span>.</span></dt>
<dd><span class="first last">D' is defined</span></dd>
<dt><span class="coqdoc-keyword">Identity</span><span> </span><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">IdD'D</span><span> : </span><span class="coqdoc-var">D'</span><span> &gt;-&gt; </span><span class="coqdoc-var">D</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Print</span><span> </span><span class="coqdoc-var">IdD'D</span><span>.</span></dt>
<dd><span class="first">IdD'D = 
(</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">fun</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (b : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">) (x : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">D'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">) =&gt; </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">) : </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> b : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">, </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">D'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">D</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> b : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">, </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">D'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">D</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last">

Argument scopes are [bool_scope _]
IdD'D is a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">d'</span><span> : </span><span class="coqdoc-var">D'</span><span> </span><span class="coqdoc-var">true</span><span>.</span></dt>
<dd><span class="first last">d' is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">T</span><span> </span><span class="coqdoc-var">d'</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">T</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">d'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">T</span><span> </span><span class="coqdoc-var">d'</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">T</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">d'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>In the case of functional arguments, we use the monotonic rule of
sub-typing. To coerce <code class="code Coq docutils literal notranslate"><span class="name"><span class="pre">t</span></span> <span class="operator"><span class="pre">:</span></span> <span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span> <span class="operator"><span class="pre">:</span></span> <span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span> <span class="name"><span class="pre">B</span></span></code> towards
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span> <span class="operator"><span class="pre">:</span></span> <span class="name"><span class="pre">A'</span></span><span class="operator"><span class="pre">,</span></span> <span class="name"><span class="pre">B'</span></span></code>, we have to coerce <code class="docutils literal notranslate"><span class="pre">A'</span></code> towards <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>
towards <code class="docutils literal notranslate"><span class="pre">B'</span></code>. An example is given below:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Parameters</span><span> (</span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">B</span><span> : </span><span class="coqdoc-keyword">Set</span><span>) (</span><span class="coqdoc-var">h</span><span> : </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">B</span><span>).</span></dt>
<dd><span class="first last">A is declared
B is declared
h is declared</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">h</span><span> : </span><span class="coqdoc-var">A</span><span> &gt;-&gt; </span><span class="coqdoc-var">B</span><span>.</span></dt>
<dd><span class="first last">h is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">U</span><span> : (</span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">E</span><span> </span><span class="coqdoc-var">true</span><span>) -&gt; </span><span class="coqdoc-var">nat</span><span>.</span></dt>
<dd><span class="first last">U is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">t</span><span> : </span><span class="coqdoc-var">B</span><span> -&gt; </span><span class="coqdoc-var">C</span><span> 0.</span></dt>
<dd><span class="first last">t is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">U</span><span> </span><span class="coqdoc-var">t</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">U</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">fun</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">t</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">U</span><span> </span><span class="coqdoc-var">t</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">U</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">fun</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">f</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0 (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">t</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">h</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">))))
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>Remark the changes in the result following the modification of the
previous example.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">U'</span><span> : (</span><span class="coqdoc-var">C</span><span> 0 -&gt; </span><span class="coqdoc-var">B</span><span>) -&gt; </span><span class="coqdoc-var">nat</span><span>.</span></dt>
<dd><span class="first last">U' is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">t'</span><span> : </span><span class="coqdoc-var">E</span><span> </span><span class="coqdoc-var">true</span><span> -&gt; </span><span class="coqdoc-var">A</span><span>.</span></dt>
<dd><span class="first last">t' is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">U'</span><span> </span><span class="coqdoc-var">t'</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">U'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">fun</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">C</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0 =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">t'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">U'</span><span> </span><span class="coqdoc-var">t'</span><span>).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">U'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">fun</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">C</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0 =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">h</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">t'</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 1 </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">f</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0 </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">))))
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
</div>
<div class="section" id="coercion-to-a-type">
<h3>Coercion to a type<a class="headerlink" href="#coercion-to-a-type" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>An assumption <code class="docutils literal notranslate"><span class="pre">x:A</span></code> when <code class="docutils literal notranslate"><span class="pre">A</span></code> is not a type, is ill-typed.  It is
replaced by <code class="docutils literal notranslate"><span class="pre">x:A'</span></code> where <code class="docutils literal notranslate"><span class="pre">A'</span></code> is the result of the application to
<code class="docutils literal notranslate"><span class="pre">A</span></code> of the coercion path between the class of <code class="docutils literal notranslate"><span class="pre">A</span></code> and
<code class="docutils literal notranslate"><span class="pre">Sortclass</span></code> if it exists.  This case occurs in the abstraction
<code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">fun</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span> <span class="operator"><span class="pre">=&gt;</span></span> <span class="name"><span class="pre">t</span></span></code>, universal quantification <code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span><span class="name"><span class="pre">B</span></span></code>, global
variables and parameters of (co-)inductive definitions and
functions. In <code class="code Coq docutils literal notranslate"><span class="keyword"><span class="pre">forall</span></span> <span class="name"><span class="pre">x</span></span><span class="operator"><span class="pre">:</span></span><span class="name"><span class="pre">A</span></span><span class="operator"><span class="pre">,</span></span><span class="name"><span class="pre">B</span></span></code>, such a coercion path may also be applied
to <code class="docutils literal notranslate"><span class="pre">B</span></code> if necessary.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">Graph</span><span> : </span><span class="coqdoc-keyword">Type</span><span>.</span></dt>
<dd><span class="first last">Graph is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">Node</span><span> : </span><span class="coqdoc-var">Graph</span><span> -&gt; </span><span class="coqdoc-keyword">Type</span><span>.</span></dt>
<dd><span class="first last">Node is declared</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">Node</span><span> : </span><span class="coqdoc-var">Graph</span><span> &gt;-&gt; </span><span class="coqdoc-var">Sortclass</span><span>.</span></dt>
<dd><span class="first last">Node is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">G</span><span> : </span><span class="coqdoc-var">Graph</span><span>.</span></dt>
<dd><span class="first last">G is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">Arrows</span><span> : </span><span class="coqdoc-var">G</span><span> -&gt; </span><span class="coqdoc-var">G</span><span> -&gt; </span><span class="coqdoc-keyword">Type</span><span>.</span></dt>
<dd><span class="first last">Arrows is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> </span><span class="coqdoc-var">Arrows</span><span>.</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">Arrows</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">fg</span><span> : </span><span class="coqdoc-var">G</span><span> -&gt; </span><span class="coqdoc-var">G</span><span>.</span></dt>
<dd><span class="first last">fg is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> </span><span class="coqdoc-var">fg</span><span>.</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">fg</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> </span><span class="coqdoc-var">fg</span><span>.</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">fg</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Node</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Node</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">G</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
</div>
<div class="section" id="coercion-to-a-function">
<h3>Coercion to a function<a class="headerlink" href="#coercion-to-a-function" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">a</span></code> is ill-typed because <code class="docutils literal notranslate"><span class="pre">f:A</span></code> is not a function. The term
<code class="docutils literal notranslate"><span class="pre">f</span></code> is replaced by the term obtained by applying to <code class="docutils literal notranslate"><span class="pre">f</span></code> the
coercion path between <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">Funclass</span></code> if it exists.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">bij</span><span> : </span><span class="coqdoc-keyword">Set</span><span> -&gt; </span><span class="coqdoc-keyword">Set</span><span> -&gt; </span><span class="coqdoc-keyword">Set</span><span>.</span></dt>
<dd><span class="first last">bij is declared</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">ap</span><span> : </span><span class="coqdoc-keyword">forall</span><span> </span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">B</span><span>:</span><span class="coqdoc-keyword">Set</span><span>, </span><span class="coqdoc-var">bij</span><span> </span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">B</span><span> -&gt; </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">B</span><span>.</span></dt>
<dd><span class="first last">ap is declared</span></dd>
<dt><span class="coqdoc-keyword">Coercion</span><span> </span><span class="coqdoc-var">ap</span><span> : </span><span class="coqdoc-var">bij</span><span> &gt;-&gt; </span><span class="coqdoc-var">Funclass</span><span>.</span></dt>
<dd><span class="first last">ap is now a coercion</span></dd>
<dt><span class="coqdoc-keyword">Parameter</span><span> </span><span class="coqdoc-var">b</span><span> : </span><span class="coqdoc-var">bij</span><span> </span><span class="coqdoc-var">nat</span><span> </span><span class="coqdoc-var">nat</span><span>.</span></dt>
<dd><span class="first last">b is declared</span></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">b</span><span> 0).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Set Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Check</span><span> (</span><span class="coqdoc-var">b</span><span> 0).</span></dt>
<dd><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative first">ap</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">b</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> 0
     : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-keyword">Unset Printing Coercions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>Let us see the resulting graph after all these examples.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Print</span><span> </span><span class="coqdoc-var">Graph</span><span>.</span></dt>
<dd><span class="first">[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool_in_nat</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : bool &gt;-&gt; nat
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">f</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : C &gt;-&gt; D
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">f</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : C &gt;-&gt; E
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : D &gt;-&gt; E
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">IdD'D</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : D' &gt;-&gt; D
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">IdD'D</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">g</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : D' &gt;-&gt; E
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">h</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : A &gt;-&gt; B
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Node</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">] : Graph &gt;-&gt; Sortclass
[</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">ap</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last">] : bij &gt;-&gt; Funclass</span></dd>
</dl>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="canonical-structures.html" class="btn btn-neutral float-right" title="Canonical Structures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="extended-pattern-matching.html" class="btn btn-neutral" title="Extended pattern matching" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1999-2018, Inria.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'8.8.2',
            LANGUAGE:'ja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/notations.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>