

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Type Classes &mdash; Coq 8.8.2 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansi.css" type="text/css" />
  <link rel="stylesheet" href="../_static/coqdoc.css" type="text/css" />
  <link rel="stylesheet" href="../_static/notations.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pre-text.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="Omega: a solver for quantifier-free problems in Presburger Arithmetic" href="omega.html" />
    <link rel="prev" title="Canonical Structures" href="canonical-structures.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Coq
          

          
          </a>

          
            
            
              <div class="version">
                8.8.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">索引</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-cmdindex.html">Command index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-tacindex.html">Tactic index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-optindex.html">Flags, options and tables index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-exnindex.html">Errors and warnings index</a></li>
</ul>
<p class="caption"><span class="caption-text">はじめに</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>
<p class="caption"><span class="caption-text">言語</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/gallina-specification-language.html">The Gallina specification language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/gallina-extensions.html">Extensions of <span class="smallcaps">Gallina</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/coq-library.html">The <span class="smallcaps">Coq</span> library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/cic.html">Calculus of Inductive Constructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/module-system.html">The Module System</a></li>
</ul>
<p class="caption"><span class="caption-text">証明エンジン</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/vernacular-commands.html">Vernacular commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/proof-handling.html">Proof handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/tactics.html">Tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ltac.html">The tactic language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/detailed-tactic-examples.html">Detailed examples of tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ssreflect-proof-language.html">The <span class="smallcaps">SSReflect</span> proof language</a></li>
</ul>
<p class="caption"><span class="caption-text">ユーザ拡張</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/syntax-extensions.html">Syntax extensions and interpretation scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/proof-schemes.html">Proof schemes</a></li>
</ul>
<p class="caption"><span class="caption-text">実用ツール</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coq-commands.html">The <span class="smallcaps">Coq</span> commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coqide.html"><span class="smallcaps">Coq</span> Integrated Development Environment</a></li>
</ul>
<p class="caption"><span class="caption-text">付録</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="extended-pattern-matching.html">Extended pattern matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit-coercions.html">Implicit Coercions</a></li>
<li class="toctree-l1"><a class="reference internal" href="canonical-structures.html">Canonical Structures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Type Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-and-instance-declarations">Class and Instance declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#binding-classes">Binding classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameterized-instances">Parameterized Instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sections-and-contexts">Sections and contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-hierarchies">Building hierarchies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#superclasses">Superclasses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#substructures">Substructures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-the-commands">Summary of the commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#typeclasses-transparent-typclasses-opaque">Typeclasses Transparent, Typclasses Opaque</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typeclasses-eauto">Typeclasses eauto <cite>:=</cite></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omega.html">Omega: a solver for quantifier-free problems in Presburger Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="micromega.html">Micromega: tactics for solving arithmetic goals over ordered rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="extraction.html">Extraction of programs in <span class="smallcaps">OCaml</span> and Haskell</a></li>
<li class="toctree-l1"><a class="reference internal" href="program.html">Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring.html">The ring and field tactic families</a></li>
<li class="toctree-l1"><a class="reference internal" href="nsatz.html">Nsatz: tactics for proving equalities in integral domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="generalized-rewriting.html">Generalized rewriting</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel-proof-processing.html">Asynchronous and Parallel Proof Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous-extensions.html">Miscellaneous extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="universe-polymorphism.html">Polymorphic Universes</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zebibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Coq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Type Classes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/coq/coq/blob/master/doc/sphinx/addendum/type-classes.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="math-preamble math notranslate">
\[\begin{split}\newcommand{\alors}{\textsf{then}}
\newcommand{\alter}{\textsf{alter}}
\newcommand{\as}{\kw{as}}
\newcommand{\Assum}[3]{\kw{Assum}(#1)(#2:#3)}
\newcommand{\bool}{\textsf{bool}}
\newcommand{\case}{\kw{case}}
\newcommand{\conc}{\textsf{conc}}
\newcommand{\cons}{\textsf{cons}}
\newcommand{\consf}{\textsf{consf}}
\newcommand{\conshl}{\textsf{cons\_hl}}
\newcommand{\Def}[4]{\kw{Def}(#1)(#2:=#3:#4)}
\newcommand{\emptyf}{\textsf{emptyf}}
\newcommand{\End}{\kw{End}}
\newcommand{\kwend}{\kw{end}}
\newcommand{\EqSt}{\textsf{EqSt}}
\newcommand{\even}{\textsf{even}}
\newcommand{\evenO}{\textsf{even}_\textsf{O}}
\newcommand{\evenS}{\textsf{even}_\textsf{S}}
\newcommand{\false}{\textsf{false}}
\newcommand{\filter}{\textsf{filter}}
\newcommand{\Fix}{\kw{Fix}}
\newcommand{\fix}{\kw{fix}}
\newcommand{\for}{\textsf{for}}
\newcommand{\forest}{\textsf{forest}}
\newcommand{\from}{\textsf{from}}
\newcommand{\Functor}{\kw{Functor}}
\newcommand{\haslength}{\textsf{has\_length}}
\newcommand{\hd}{\textsf{hd}}
\newcommand{\ident}{\textsf{ident}}
\newcommand{\In}{\kw{in}}
\newcommand{\Ind}[4]{\kw{Ind}[#2](#3:=#4)}
\newcommand{\ind}[3]{\kw{Ind}~[#1]\left(#2\mathrm{~:=~}#3\right)}
\newcommand{\Indp}[5]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)}
\newcommand{\Indpstr}[6]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)/{#6}}
\newcommand{\injective}{\kw{injective}}
\newcommand{\kw}[1]{\textsf{#1}}
\newcommand{\lb}{\lambda}
\newcommand{\length}{\textsf{length}}
\newcommand{\letin}[3]{\kw{let}~#1:=#2~\kw{in}~#3}
\newcommand{\List}{\textsf{list}}
\newcommand{\lra}{\longrightarrow}
\newcommand{\Match}{\kw{match}}
\newcommand{\Mod}[3]{{\kw{Mod}}({#1}:{#2}\,\zeroone{:={#3}})}
\newcommand{\ModA}[2]{{\kw{ModA}}({#1}=={#2})}
\newcommand{\ModS}[2]{{\kw{Mod}}({#1}:{#2})}
\newcommand{\ModType}[2]{{\kw{ModType}}({#1}:={#2})}
\newcommand{\mto}{.\;}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\nat}{\textsf{nat}}
\newcommand{\Nil}{\textsf{nil}}
\newcommand{\nilhl}{\textsf{nil\_hl}}
\newcommand{\nO}{\textsf{O}}
\newcommand{\node}{\textsf{node}}
\newcommand{\nS}{\textsf{S}}
\newcommand{\odd}{\textsf{odd}}
\newcommand{\oddS}{\textsf{odd}_\textsf{S}}
\newcommand{\ovl}[1]{\overline{#1}}
\newcommand{\Pair}{\textsf{pair}}
\newcommand{\Prod}{\textsf{prod}}
\newcommand{\Prop}{\textsf{Prop}}
\newcommand{\return}{\kw{return}}
\newcommand{\Set}{\textsf{Set}}
\newcommand{\si}{\textsf{if}}
\newcommand{\sinon}{\textsf{else}}
\newcommand{\Sort}{\cal S}
\newcommand{\Str}{\textsf{Stream}}
\newcommand{\Struct}{\kw{Struct}}
\newcommand{\subst}[3]{#1\{#2/#3\}}
\newcommand{\tl}{\textsf{tl}}
\newcommand{\tree}{\textsf{tree}}
\newcommand{\true}{\textsf{true}}
\newcommand{\Type}{\textsf{Type}}
\newcommand{\unfold}{\textsf{unfold}}
\newcommand{\WEV}[3]{\mbox{$#1[] \vdash #2 \lra  #3$}}
\newcommand{\WEVT}[3]{\mbox{$#1[] \vdash #2 \lra$}\\ \mbox{$ #3$}}
\newcommand{\WF}[2]{{\cal W\!F}(#1)[#2]}
\newcommand{\WFE}[1]{\WF{E}{#1}}
\newcommand{\WFT}[2]{#1[] \vdash {\cal W\!F}(#2)}
\newcommand{\WFTWOLINES}[2]{{\cal W\!F}\begin{array}{l}(#1)\\\mbox{}[{#2}]\end{array}}
\newcommand{\with}{\kw{with}}
\newcommand{\WS}[3]{#1[] \vdash #2 &lt;: #3}
\newcommand{\WSE}[2]{\WS{E}{#1}{#2}}
\newcommand{\WT}[4]{#1[#2] \vdash #3 : #4}
\newcommand{\WTE}[3]{\WT{E}{#1}{#2}{#3}}
\newcommand{\WTEG}[2]{\WTE{\Gamma}{#1}{#2}}
\newcommand{\WTM}[3]{\WT{#1}{}{#2}{#3}}
\newcommand{\zeroone}[1]{[{#1}]}
\newcommand{\zeros}{\textsf{zeros}}
\end{split}\]</div>
<div class="section" id="type-classes">
<span id="typeclasses"></span><h1>Type Classes<a class="headerlink" href="#type-classes" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>This chapter presents a quick reference of the commands related to type
classes. For an actual introduction to typeclasses, there is a
description of the system <a class="reference internal" href="../zebibliography.html#sozeau08" id="id1">[SO08]</a> and the literature on type
classes in Haskell which also applies.</p>
<div class="section" id="class-and-instance-declarations">
<h2>Class and Instance declarations<a class="headerlink" href="#class-and-instance-declarations" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The syntax for class and instance declarations is the same as the record
syntax of Coq:</p>
<p><code class="docutils literal notranslate"><span class="pre">Class</span> <span class="pre">Id</span> <span class="pre">(</span></code> <cite>p</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>t</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">)</span> <span class="pre">⋯</span> <span class="pre">(</span></code> <cite>p</cite><span class="math notranslate">\(_{n}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>t</cite><span class="math notranslate">\(_{n}\)</span> <code class="docutils literal notranslate"><span class="pre">)</span> <span class="pre">[:</span>
<span class="pre">sort]</span> <span class="pre">:=</span> <span class="pre">{</span></code> <cite>f</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>u</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">⋮</span></code> <cite>f</cite><span class="math notranslate">\(_{m}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>u</cite><span class="math notranslate">\(_{m}\)</span> <code class="docutils literal notranslate"><span class="pre">}.</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Instance</span> <span class="pre">ident</span> <span class="pre">:</span> <span class="pre">Id</span></code> <cite>p</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">⋯</span></code> <cite>p</cite><span class="math notranslate">\(_{n}\)</span> <code class="docutils literal notranslate"><span class="pre">:=</span> <span class="pre">{</span></code> <cite>f</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>t</cite><span class="math notranslate">\(_{1}\)</span> <code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">⋮</span></code> <cite>f</cite><span class="math notranslate">\(_{m}\)</span> <code class="docutils literal notranslate"><span class="pre">:=</span></code> <cite>t</cite><span class="math notranslate">\(_{m}\)</span> <code class="docutils literal notranslate"><span class="pre">}.</span></code></p>
<p>The <cite>p</cite><span class="math notranslate">\(_{i}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>t</cite><span class="math notranslate">\(_{i}\)</span> variables are called the <em>parameters</em> of the class and
the <cite>f</cite><span class="math notranslate">\(_{i}\)</span> <code class="docutils literal notranslate"><span class="pre">:</span></code> <cite>t</cite><span class="math notranslate">\(_{i}\)</span> are called the <em>methods</em>. Each class definition gives
rise to a corresponding record declaration and each instance is a
regular definition whose name is given by ident and type is an
instantiation of the record type.</p>
<p>We’ll use the following example class in the rest of the chapter:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Class</span><span> </span><span class="coqdoc-var">EqDec</span><span> (</span><span class="coqdoc-var">A</span><span> : </span><span class="coqdoc-keyword">Type</span><span>) := {</span><span>
&nbsp;&nbsp;</span><span class="coqdoc-var">eqb</span><span> : </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">bool</span><span> ;</span><span>
&nbsp;&nbsp;</span><span class="coqdoc-var">eqb_leibniz</span><span> : </span><span class="coqdoc-keyword">forall</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>, </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> = </span><span class="coqdoc-var">true</span><span> -&gt; </span><span class="coqdoc-var">x</span><span> = </span><span class="coqdoc-var">y</span><span> }.</span></dt>
<dd class="coqtop-hidden"><span class="first last">EqDec is defined
eqb is defined
eqb_leibniz is defined</span></dd>
</dl>
</div>
<p>This class implements a boolean equality test which is compatible with
Leibniz equality on some type. An example implementation is:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Instance</span><span> </span><span class="coqdoc-var">unit_EqDec</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">unit</span><span> :=</span><span>
&nbsp;{ </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> := </span><span class="coqdoc-var">true</span><span> ;</span><span>
&nbsp;&nbsp;&nbsp;</span><span class="coqdoc-var">eqb_leibniz</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-var">H</span><span> :=</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="coqdoc-keyword">match</span><span> </span><span class="coqdoc-var">x</span><span>, </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-keyword">return</span><span> </span><span class="coqdoc-var">x</span><span> = </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-keyword">with</span><span> </span><span class="coqdoc-var">tt</span><span>, </span><span class="coqdoc-var">tt</span><span> =&gt; </span><span class="coqdoc-var">eq_refl</span><span> </span><span class="coqdoc-var">tt</span><span> </span><span class="coqdoc-keyword">end</span><span> }.</span></dt>
<dd class="coqtop-hidden"><span class="first last">unit_EqDec is defined</span></dd>
</dl>
</div>
<p>If one does not give all the members in the Instance declaration, Coq
enters the proof-mode and the user is asked to build inhabitants of
the remaining fields, e.g.:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Instance</span><span> </span><span class="coqdoc-var">eq_bool</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">bool</span><span> :=</span><span>
{ </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> := </span><span class="coqdoc-keyword">if</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-keyword">then</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-keyword">else</span><span> </span><span class="coqdoc-var">negb</span><span> </span><span class="coqdoc-var">y</span><span> }.</span></dt>
<dd class="coqtop-hidden"><span class="first">1 subgoal
  
  ============================
  </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x y : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">, (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">if</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">then</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">else</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">negb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)</span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
</dl>
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Proof</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-tactic">intros</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-var">H</span><span>.</span></dt>
<dd><span class="first">1 subgoal
  
  x, y : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">bool</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  H : (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">if</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">then</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">else</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">negb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)</span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  ============================
  </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
</dl>
<span></span><dl class="docutils">
<dt><span class="coqdoc-tactic">destruct</span><span> </span><span class="coqdoc-var">x</span><span> ; </span><span class="coqdoc-tactic">destruct</span><span> </span><span class="coqdoc-var">y</span><span> ; (</span><span class="coqdoc-tactic">discriminate</span><span> || </span><span class="coqdoc-tactic">reflexivity</span><span>).</span></dt>
<dd><span class="first last">No more subgoals.</span></dd>
</dl>
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Defined</span><span>.</span></dt>
<dd><span class="first last">eq_bool is defined</span></dd>
</dl>
</div>
<p>One has to take care that the transparency of every field is
determined by the transparency of the <a class="reference internal" href="#coq:cmd.instance" title="Instance"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Instance</span></code></a> proof. One can use
alternatively the <a class="reference internal" href="#coq:cmdv.program-instance" title="Program Instance"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Program</span> <span class="pre">Instance</span></code></a> variant which has richer facilities
for dealing with obligations.</p>
</div>
<div class="section" id="binding-classes">
<h2>Binding classes<a class="headerlink" href="#binding-classes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Once a typeclass is declared, one can use it in class binders:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">neqb</span><span> {</span><span class="coqdoc-var">A</span><span>} {</span><span class="coqdoc-var">eqa</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>} (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">negb</span><span> (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>).</span></dt>
<dd><span class="first last">neqb is defined</span></dd>
</dl>
</div>
<p>When one calls a class method, a constraint is generated that is
satisfied only in contexts where the appropriate instances can be
found. In the example above, a constraint <code class="docutils literal notranslate"><span class="pre">EqDec</span> <span class="pre">A</span></code> is generated and
satisfied by <code class="docutils literal notranslate"><span class="pre">eqa</span> <span class="pre">:</span> <span class="pre">EqDec</span> <span class="pre">A</span></code>. In case no satisfying constraint can be
found, an error is raised:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-var">Fail</span><span> </span><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">neqb'</span><span> (</span><span class="coqdoc-var">A</span><span> : </span><span class="coqdoc-keyword">Type</span><span>) (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">negb</span><span> (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>).</span></dt>
<dd><span class="first">The command has indeed failed with message:
Unable to satisfy the following constraints:
In environment:
A : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
x, y : </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">

?EqDec : &quot;</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last">&quot;</span></dd>
</dl>
</div>
<p>The algorithm used to solve constraints is a variant of the <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.eauto" title="eauto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">eauto</span></code></a>
tactic that does proof search with a set of lemmas (the instances). It
will use local hypotheses as well as declared lemmas in
the <code class="docutils literal notranslate"><span class="pre">typeclass_instances</span></code> database. Hence the example can also be
written:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">neqb'</span><span> </span><span class="coqdoc-var">A</span><span> (</span><span class="coqdoc-var">eqa</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>) (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">negb</span><span> (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>).</span></dt>
<dd><span class="first last">neqb' is defined</span></dd>
</dl>
</div>
<p>However, the generalizing binders should be used instead as they have
particular support for typeclasses:</p>
<ul class="simple">
<li>They automatically set the maximally implicit status for typeclass
arguments, making derived functions as easy to use as class methods.
In the example above, <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">eqa</span></code> should be set maximally implicit.</li>
<li>They support implicit quantification on partially applied type
classes (<a class="reference internal" href="../language/gallina-extensions.html#implicit-generalization"><span class="std std-ref">Implicit generalization</span></a>). Any argument not given as part of a typeclass
binder will be automatically generalized.</li>
<li>They also support implicit quantification on <a class="reference internal" href="#superclasses"><span class="std std-ref">Superclasses</span></a>.</li>
</ul>
<p>Following the previous example, one can write:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Generalizable</span><span> </span><span class="coqdoc-keyword">Variables</span><span> </span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">B</span><span> </span><span class="coqdoc-var">C</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">neqb_implicit</span><span> `{</span><span class="coqdoc-var">eqa</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>} (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">negb</span><span> (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>).</span></dt>
<dd><span class="first last">neqb_implicit is defined</span></dd>
</dl>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">A</span></code> is implicitly generalized, and the resulting function is
equivalent to the one above.</p>
</div>
<div class="section" id="parameterized-instances">
<h2>Parameterized Instances<a class="headerlink" href="#parameterized-instances" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>One can declare parameterized instances as in Haskell simply by giving
the constraints as a binding context before the instance, e.g.:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Instance</span><span> </span><span class="coqdoc-var">prod_eqb</span><span> `(</span><span class="coqdoc-var">EA</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>, </span><span class="coqdoc-var">EB</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">B</span><span>) : </span><span class="coqdoc-var">EqDec</span><span> (</span><span class="coqdoc-var">A</span><span> * </span><span class="coqdoc-var">B</span><span>) :=</span><span>
{ </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> := </span><span class="coqdoc-keyword">match</span><span> </span><span class="coqdoc-var">x</span><span>, </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-keyword">with</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (</span><span class="coqdoc-var">la</span><span>, </span><span class="coqdoc-var">ra</span><span>), (</span><span class="coqdoc-var">lb</span><span>, </span><span class="coqdoc-var">rb</span><span>) =&gt; </span><span class="coqdoc-var">andb</span><span> (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">la</span><span> </span><span class="coqdoc-var">lb</span><span>) (</span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">ra</span><span> </span><span class="coqdoc-var">rb</span><span>)</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="coqdoc-keyword">end</span><span> }.</span></dt>
<dd class="coqtop-hidden"><span class="first">1 subgoal
  
  A : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  EA : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  B : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  EB : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">B</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  ============================
  </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x y : </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> *</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">B</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">,
  (</span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">let</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (la, ra) := </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative"> in</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">let</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (lb, rb) := </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative"> in</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">eqb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">la</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">lb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> &amp;&amp;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">eqb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">ra</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">rb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">)%bool)</span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
</dl>
<span></span><dl class="docutils">
<dt class="coqtop-hidden"><span class="coqdoc-keyword">Abort</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>These instances are used just as well as lemmas in the instance hint
database.</p>
</div>
<div class="section" id="sections-and-contexts">
<h2>Sections and contexts<a class="headerlink" href="#sections-and-contexts" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>To ease the parametrization of developments by typeclasses, we provide a new
way to introduce variables into section contexts, compatible with the implicit
argument mechanism. The new command works similarly to the <a class="reference internal" href="../language/gallina-specification-language.html#coq:cmdv.variables" title="Variables"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Variables</span></code></a>
vernacular, except it accepts any binding context as argument. For example:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Section</span><span> </span><span class="coqdoc-var">EqDec_defs</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Context</span><span> `{</span><span class="coqdoc-var">EA</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>}.</span></dt>
<dd><span class="first last">A is declared
EA is declared</span></dd>
<dt><span class="coqdoc-keyword">Global Instance</span><span> </span><span class="coqdoc-var">option_eqb</span><span> : </span><span class="coqdoc-var">EqDec</span><span> (</span><span class="coqdoc-var">option</span><span> </span><span class="coqdoc-var">A</span><span>) :=</span><span>
&nbsp;&nbsp;{ </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> := </span><span class="coqdoc-keyword">match</span><span> </span><span class="coqdoc-var">x</span><span>, </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-keyword">with</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </span><span class="coqdoc-var">Some</span><span> </span><span class="coqdoc-var">x</span><span>, </span><span class="coqdoc-var">Some</span><span> </span><span class="coqdoc-var">y</span><span> =&gt; </span><span class="coqdoc-var">eqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </span><span class="coqdoc-var">None</span><span>, </span><span class="coqdoc-var">None</span><span> =&gt; </span><span class="coqdoc-var">true</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </span><span class="coqdoc-var">_</span><span>, </span><span class="coqdoc-var">_</span><span> =&gt; </span><span class="coqdoc-var">false</span><span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="coqdoc-keyword">end</span><span> }.</span></dt>
<dd><span class="first">1 subgoal
  
  A : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  EA : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  ============================
  </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> x y : </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">option</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">,
  </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">match</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">with</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Some</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x0</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">match</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">with</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
               | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Some</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y0</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">eqb</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x0</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y0</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
               | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">None</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">false</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
               </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">end</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">None</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">match</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">with</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
            | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">Some</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> _ =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">false</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
            | </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">None</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =&gt; </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
            </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">end</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">
  </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">end</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">true</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">x</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> =</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">y</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last"></span></dd>
<dt><span class="coqdoc-var">Admitted</span><span>.</span></dt>
<dd><span class="first last">option_eqb is declared</span></dd>
<dt><span class="coqdoc-keyword">End</span><span> </span><span class="coqdoc-var">EqDec_defs</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">About</span><span> </span><span class="coqdoc-var">option_eqb</span><span>.</span></dt>
<dd><span class="first">option_eqb : </span><span class="ansi-fg-default ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">forall</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> A : </span><span class="ansi-fg-yellow ansi-bg-default ansi-bold ansi-no-italic ansi-no-underline ansi-no-negative">Type</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">, </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"></span><span class="ansi-fg-white ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> -&gt;</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">EqDec</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> (</span><span class="ansi-fg-light-green ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">option</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative"> </span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative">A</span><span class="ansi-fg-default ansi-bg-default ansi-no-bold ansi-no-italic ansi-no-underline ansi-no-negative last">)

Arguments A, EA are implicit and maximally inserted
Argument scopes are [type_scope _]
Expands to: Constant Top.option_eqb</span></dd>
</dl>
</div>
<p>Here the Global modifier redeclares the instance at the end of the
section, once it has been generalized by the context variables it
uses.</p>
</div>
<div class="section" id="building-hierarchies">
<h2>Building hierarchies<a class="headerlink" href="#building-hierarchies" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="superclasses">
<span id="id2"></span><h3>Superclasses<a class="headerlink" href="#superclasses" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>One can also parameterize classes by other classes, generating a
hierarchy of classes and superclasses. In the same way, we give the
superclasses as a binding context:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Class</span><span> </span><span class="coqdoc-var">Ord</span><span> `(</span><span class="coqdoc-var">E</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>) := { </span><span class="coqdoc-var">le</span><span> : </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">A</span><span> -&gt; </span><span class="coqdoc-var">bool</span><span> }.</span></dt>
<dd><span class="first last">Ord is defined
le is defined</span></dd>
</dl>
</div>
<p>Contrary to Haskell, we have no special syntax for superclasses, but
this declaration is equivalent to:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Class `(E : EqDec A) =&gt; Ord A :=
  { le : A -&gt; A -&gt; bool }.
</pre></div>
</div>
<p>This declaration means that any instance of the <code class="docutils literal notranslate"><span class="pre">Ord</span></code> class must have
an instance of <code class="docutils literal notranslate"><span class="pre">EqDec</span></code>. The parameters of the subclass contain at
least all the parameters of its superclasses in their order of
appearance (here A is the only one). As we have seen, <code class="docutils literal notranslate"><span class="pre">Ord</span></code> is encoded
as a record type with two parameters: a type <code class="docutils literal notranslate"><span class="pre">A</span></code> and an <code class="docutils literal notranslate"><span class="pre">E</span></code> of type
<code class="docutils literal notranslate"><span class="pre">EqDec</span> <span class="pre">A</span></code>. However, one can still use it as if it had a single
parameter inside generalizing binders: the generalization of
superclasses will be done automatically.</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">le_eqb</span><span> `{</span><span class="coqdoc-var">Ord</span><span> </span><span class="coqdoc-var">A</span><span>} (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">andb</span><span> (</span><span class="coqdoc-var">le</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>) (</span><span class="coqdoc-var">le</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-var">x</span><span>).</span></dt>
<dd><span class="first last">le_eqb is defined</span></dd>
</dl>
</div>
<p>In some cases, to be able to specify sharing of structures, one may
want to give explicitly the superclasses. It is is possible to do it
directly in regular binders, and using the <code class="docutils literal notranslate"><span class="pre">!</span></code> modifier in class
binders. For example:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Definition</span><span> </span><span class="coqdoc-var">lt</span><span> `{</span><span class="coqdoc-var">eqa</span><span> : </span><span class="coqdoc-var">EqDec</span><span> </span><span class="coqdoc-var">A</span><span>, ! </span><span class="coqdoc-var">Ord</span><span> </span><span class="coqdoc-var">eqa</span><span>} (</span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> : </span><span class="coqdoc-var">A</span><span>) := </span><span class="coqdoc-var">andb</span><span> (</span><span class="coqdoc-var">le</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>) (</span><span class="coqdoc-var">neqb</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span>).</span></dt>
<dd><span class="first last">lt is defined</span></dd>
</dl>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">!</span></code> modifier switches the way a binder is parsed back to the regular
interpretation of Coq. In particular, it uses the implicit arguments
mechanism if available, as shown in the example.</p>
</div>
<div class="section" id="substructures">
<h3>Substructures<a class="headerlink" href="#substructures" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Substructures are components of a class which are instances of a class
themselves. They often arise when using classes for logical
properties, e.g.:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt class="coqtop-hidden"><span class="coqdoc-keyword">Require</span><span> </span><span class="coqdoc-keyword">Import</span><span> </span><span class="coqdoc-var">Relation_Definitions</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Class</span><span> </span><span class="coqdoc-var">Reflexive</span><span> (</span><span class="coqdoc-var">A</span><span> : </span><span class="coqdoc-keyword">Type</span><span>) (</span><span class="coqdoc-var">R</span><span> : </span><span class="coqdoc-var">relation</span><span> </span><span class="coqdoc-var">A</span><span>) :=</span><span>
&nbsp;&nbsp;</span><span class="coqdoc-tactic">reflexivity</span><span> : </span><span class="coqdoc-keyword">forall</span><span> </span><span class="coqdoc-var">x</span><span>, </span><span class="coqdoc-var">R</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">x</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
<dt><span class="coqdoc-keyword">Class</span><span> </span><span class="coqdoc-var">Transitive</span><span> (</span><span class="coqdoc-var">A</span><span> : </span><span class="coqdoc-keyword">Type</span><span>) (</span><span class="coqdoc-var">R</span><span> : </span><span class="coqdoc-var">relation</span><span> </span><span class="coqdoc-var">A</span><span>) :=</span><span>
&nbsp;&nbsp;</span><span class="coqdoc-tactic">transitivity</span><span> : </span><span class="coqdoc-keyword">forall</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-var">z</span><span>, </span><span class="coqdoc-var">R</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">y</span><span> -&gt; </span><span class="coqdoc-var">R</span><span> </span><span class="coqdoc-var">y</span><span> </span><span class="coqdoc-var">z</span><span> -&gt; </span><span class="coqdoc-var">R</span><span> </span><span class="coqdoc-var">x</span><span> </span><span class="coqdoc-var">z</span><span>.</span></dt>
<dd class="coqtop-hidden"></dd>
</dl>
</div>
<p>This declares singleton classes for reflexive and transitive relations,
(see the <a class="reference internal" href="#singleton-class"><span class="std std-ref">singleton class</span></a> variant for an
explanation). These may be used as parts of other classes:</p>
<div class="coqtop literal-block docutils container">
<span></span><dl class="docutils">
<dt><span class="coqdoc-keyword">Class</span><span> </span><span class="coqdoc-var">PreOrder</span><span> (</span><span class="coqdoc-var">A</span><span> : </span><span class="coqdoc-keyword">Type</span><span>) (</span><span class="coqdoc-var">R</span><span> : </span><span class="coqdoc-var">relation</span><span> </span><span class="coqdoc-var">A</span><span>) :=</span><span>
{ </span><span class="coqdoc-var">PreOrder_Reflexive</span><span> :&gt; </span><span class="coqdoc-var">Reflexive</span><span> </span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">R</span><span> ;</span><span>
&nbsp;&nbsp;</span><span class="coqdoc-var">PreOrder_Transitive</span><span> :&gt; </span><span class="coqdoc-var">Transitive</span><span> </span><span class="coqdoc-var">A</span><span> </span><span class="coqdoc-var">R</span><span> }.</span></dt>
<dd><span class="first last">PreOrder is defined
PreOrder_Reflexive is defined
PreOrder_Transitive is defined</span></dd>
</dl>
</div>
<p>The syntax <code class="docutils literal notranslate"><span class="pre">:&gt;</span></code> indicates that each <code class="docutils literal notranslate"><span class="pre">PreOrder</span></code> can be seen as a
<code class="docutils literal notranslate"><span class="pre">Reflexive</span></code> relation. So each time a reflexive relation is needed, a
preorder can be used instead. This is very similar to the coercion
mechanism of <code class="docutils literal notranslate"><span class="pre">Structure</span></code> declarations. The implementation simply
declares each projection as an instance.</p>
<p>One can also declare existing objects or structure projections using
the Existing Instance command to achieve the same effect.</p>
</div>
</div>
<div class="section" id="summary-of-the-commands">
<h2>Summary of the commands<a class="headerlink" href="#summary-of-the-commands" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="cmd">
<dt id="coq:cmd.class">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Class</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-sort"><span class="hole">sort</span></a></span><span class="notation-sup">?</span></span> <span>:=</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">?</span></span> <span class="curlies">{ <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span><span class="repeat-wrapper"><span class="repeat"><span>&gt;</span></span><span class="notation-sup">?</span></span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span><span class="notation-sup">+</span><span class="notation-sub">;</span></span> }</span></span></code><a class="headerlink" href="#coq:cmd.class" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>The <a class="reference internal" href="#coq:cmd.class" title="Class"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Class</span></code></a> command is used to declare a typeclass with parameters
<code class="docutils literal notranslate"><span class="pre">binders</span></code> and fields the declared record fields.</p>
</dd></dl>

<p>Variants:</p>
<span class="target" id="singleton-class"></span><dl class="cmd">
<dt>
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Class</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-sort"><span class="hole">sort</span></a></span><span class="notation-sup">?</span></span> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span>:</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span></code></dt>
<dd><p>This variant declares a <em>singleton</em> class with a single method.  This
singleton class is a so-called definitional class, represented simply
as a definition <code class="docutils literal notranslate"><span class="pre">ident</span> <span class="pre">binders</span> <span class="pre">:=</span> <span class="pre">term</span></code> and whose instances are
themselves objects of this type. Definitional classes are not wrapped
inside records, and the trivial projection of an instance of such a
class is convertible to the instance itself. This can be useful to
make instances of existing objects easily and to reduce proof size by
not inserting useless projections. The class constant itself is
declared rigid during resolution so that the class abstraction is
maintained.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.existing-class">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Existing</span> <span>Class</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span></code><a class="headerlink" href="#coq:cmd.existing-class" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This variant declares a class a posteriori from a constant or
inductive definition. No methods or instances are defined.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.instance">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Instance</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <span>Class</span> <span>t1</span> <span>…</span> <span>tn</span> <span>[|</span> <span>priority]</span> <span>:=</span> <span class="curlies">{ <span>field1</span> <span>:=</span> <span>b1</span> <span>;</span> <span>…;</span> <span>fieldi</span> <span>:=</span> <span>bi</span> }</span></span></code><a class="headerlink" href="#coq:cmd.instance" title="この定義へのパーマリンク">¶</a></dt>
<dd></dd></dl>

<p>The <a class="reference internal" href="#coq:cmd.instance" title="Instance"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Instance</span></code></a> command is used to declare a typeclass instance named
<code class="docutils literal notranslate"><span class="pre">ident</span></code> of the class <a class="reference internal" href="#coq:cmd.class" title="Class"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Class</span></code></a> with parameters <code class="docutils literal notranslate"><span class="pre">t1</span></code> to <code class="docutils literal notranslate"><span class="pre">tn</span></code> and
fields <code class="docutils literal notranslate"><span class="pre">b1</span></code> to <code class="docutils literal notranslate"><span class="pre">bi</span></code>, where each field must be a declared field of
the class.  Missing fields must be filled in interactive proof mode.</p>
<p>An arbitrary context of <code class="docutils literal notranslate"><span class="pre">binders</span></code> can be put after the name of the
instance and before the colon to declare a parameterized instance. An
optional priority can be declared, 0 being the highest priority as for
<a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.auto" title="auto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">auto</span></code></a> hints. If the priority is not specified, it defaults to the number
of non-dependent binders of the instance.</p>
<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Instance</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span> <span>:</span> <span>forall</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span><span class="notation-sup">?</span></span><span>,</span> <span>Class</span> <span>t1</span> <span>…</span> <span>tn</span> <span>[|</span> <span>priority]</span> <span>:=</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a></span></code></dt>
<dd><p>This syntax is used for declaration of singleton class instances or
for directly giving an explicit term of type <code class="docutils literal notranslate"><span class="pre">forall</span> <span class="pre">binders,</span> <span class="pre">Class</span>
<span class="pre">t1</span> <span class="pre">…</span> <span class="pre">tn</span></code>.  One need not even mention the unique field name for
singleton classes.</p>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Global</span> <span>Instance</span></span></code></dt>
<dd><p>One can use the <code class="docutils literal notranslate"><span class="pre">Global</span></code> modifier on instances declared in a
section so that their generalization is automatically redeclared
after the section is closed.</p>
</dd></dl>

<dl class="cmdv">
<dt id="coq:cmdv.program-instance">
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Program</span> <span>Instance</span></span></code><a class="headerlink" href="#coq:cmdv.program-instance" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Switches the type checking to Program (chapter <a class="reference internal" href="program.html#programs"><span class="std std-ref">Program</span></a>) and
uses the obligation mechanism to manage missing fields.</p>
</dd></dl>

<dl class="cmdv">
<dt id="coq:cmdv.declare-instance">
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>Declare</span> <span>Instance</span></span></code><a class="headerlink" href="#coq:cmdv.declare-instance" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>In a Module Type, this command states that a corresponding concrete
instance should exist in any implementation of this Module Type. This
is similar to the distinction between <a class="reference internal" href="../language/gallina-specification-language.html#coq:cmd.parameter" title="Parameter"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Parameter</span></code></a> vs. <a class="reference internal" href="../language/gallina-specification-language.html#coq:cmd.definition" title="Definition"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Definition</span></code></a>, or
between <a class="reference internal" href="../language/gallina-extensions.html#coq:cmd.declare-module" title="Declare Module"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Declare</span> <span class="pre">Module</span></code></a> and <a class="reference internal" href="../language/gallina-extensions.html#coq:cmd.module" title="Module"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Module</span></code></a>.</p>
</dd></dl>

<p>Besides the <a class="reference internal" href="#coq:cmd.class" title="Class"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Class</span></code></a> and <a class="reference internal" href="#coq:cmd.instance" title="Instance"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Instance</span></code></a> vernacular commands, there are a
few other commands related to typeclasses.</p>
<dl class="cmd">
<dt id="coq:cmd.existing-instance">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Existing</span> <span>Instance</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">+</span></span> <span>[|</span> <span>priority]</span></span></code><a class="headerlink" href="#coq:cmd.existing-instance" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This command adds an arbitrary list of constants whose type ends with
an applied typeclass to the instance database with an optional
priority.  It can be used for redeclaring instances at the end of
sections, or declaring structure projections as instances. This is
equivalent to <code class="docutils literal notranslate"><span class="pre">Hint</span> <span class="pre">Resolve</span> <span class="pre">ident</span> <span class="pre">:</span> <span class="pre">typeclass_instances</span></code>, except it
registers instances for <a class="reference internal" href="generalized-rewriting.html#coq:cmd.print-instances" title="Print Instances"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Print</span> <span class="pre">Instances</span></code></a>.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.context">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Context</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-binders"><span class="hole">binders</span></a></span></code><a class="headerlink" href="#coq:cmd.context" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Declares variables according to the given binding context, which might
use <a class="reference internal" href="../language/gallina-extensions.html#implicit-generalization"><span class="std std-ref">Implicit generalization</span></a>.</p>
</dd></dl>

<dl class="tacn">
<dt id="coq:tacn.typeclasses-eauto">
<code class="descname"><span class="notation"><span>typeclasses</span> <span>eauto</span></span></code><a class="headerlink" href="#coq:tacn.typeclasses-eauto" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This tactic uses a different resolution engine than <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.eauto" title="eauto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">eauto</span></code></a> and
<a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.auto" title="auto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">auto</span></code></a>. The main differences are the following:</p>
<ul>
<li><p class="first">Contrary to <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.eauto" title="eauto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">eauto</span></code></a> and <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.auto" title="auto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">auto</span></code></a>, the resolution is done entirely in
the new proof engine (as of Coq 8.6), meaning that backtracking is
available among dependent subgoals, and shelving goals is supported.
<code class="docutils literal notranslate"><span class="pre">typeclasses</span> <span class="pre">eauto</span></code> is a multi-goal tactic. It analyses the dependencies
between subgoals to avoid backtracking on subgoals that are entirely
independent.</p>
</li>
<li><p class="first">When called with no arguments, <code class="docutils literal notranslate"><span class="pre">typeclasses</span> <span class="pre">eauto</span></code> uses
the <code class="docutils literal notranslate"><span class="pre">typeclass_instances</span></code> database by default (instead of core).
Dependent subgoals are automatically shelved, and shelved goals can
remain after resolution ends (following the behavior of Coq 8.5).</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">As of Coq 8.6, <code class="docutils literal notranslate"><span class="pre">all:once</span> <span class="pre">(typeclasses</span> <span class="pre">eauto)</span></code> faithfully
mimicks what happens during typeclass resolution when it is called
during refinement/type inference, except that <em>only</em> declared class
subgoals are considered at the start of resolution during type
inference, while <code class="docutils literal notranslate"><span class="pre">all</span></code> can select non-class subgoals as well. It might
move to <code class="docutils literal notranslate"><span class="pre">all:typeclasses</span> <span class="pre">eauto</span></code> in future versions when the
refinement engine will be able to backtrack.</p>
</div>
</li>
<li><p class="first">When called with specific databases (e.g. with), <code class="docutils literal notranslate"><span class="pre">typeclasses</span> <span class="pre">eauto</span></code>
allows shelved goals to remain at any point during search and treat
typeclass goals like any other.</p>
</li>
<li><p class="first">The transparency information of databases is used consistently for
all hints declared in them. It is always used when calling the
unifier. When considering local hypotheses, we use the transparent
state of the first hint database given. Using an empty database
(created with <a class="reference internal" href="../proof-engine/tactics.html#coq:cmd.create-hintdb" title="Create HintDb"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Create</span> <span class="pre">HintDb</span></code></a> for example) with unfoldable variables and
constants as the first argument of <code class="docutils literal notranslate"><span class="pre">typeclasses</span> <span class="pre">eauto</span></code> hence makes
resolution with the local hypotheses use full conversion during
unification.</p>
</li>
</ul>
<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>typeclasses</span> <span>eauto</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-num"><span class="hole">num</span></a></span></code></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The semantics for the limit <code class="docutils literal notranslate"><span class="notation"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-num"><span class="hole"><span class="pre">num</span></span></a></span></code>
is different than for auto. By default, if no limit is given, the
search is unbounded. Contrary to <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.auto" title="auto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">auto</span></code></a>, introduction steps are
counted, which might result in larger limits being necessary when
searching with <code class="docutils literal notranslate"><span class="pre">typeclasses</span> <span class="pre">eauto</span></code> than with <a class="reference internal" href="../proof-engine/tactics.html#coq:tacn.auto" title="auto"><code class="xref coq coq-tacn docutils literal notranslate"><span class="pre">auto</span></code></a>.</p>
</div>
</dd></dl>

<dl class="cmdv">
<dt>
<em class="property"><span class="sigannot">Variant</span></em> <code class="descname"><span class="notation"><span>typeclasses</span> <span>eauto</span> <span>with</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">+</span></span></span></code></dt>
<dd><p>This variant runs resolution with the given hint databases. It treats
typeclass subgoals the same as other subgoals (no shelving of
non-typeclass goals in particular).</p>
</dd></dl>

</dd></dl>

<dl class="tacn">
<dt id="coq:tacn.autoapply">
<code class="descname"><span class="notation"><span>autoapply</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-term"><span class="hole">term</span></a> <span>with</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span></code><a class="headerlink" href="#coq:tacn.autoapply" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>The tactic <code class="docutils literal notranslate"><span class="pre">autoapply</span></code> applies a term using the transparency information
of the hint database ident, and does <em>no</em> typeclass resolution. This can
be used in <a class="reference internal" href="../proof-engine/tactics.html#coq:cmdv.hint-extern" title="Hint Extern"><code class="xref coq coq-cmd docutils literal notranslate"><span class="pre">Hint</span> <span class="pre">Extern</span></code></a>’s for typeclass instances (in the hint
database <code class="docutils literal notranslate"><span class="pre">typeclass_instances</span></code>) to allow backtracking on the typeclass
subgoals created by the lemma application, rather than doing typeclass
resolution locally at the hint application time.</p>
</dd></dl>

<div class="section" id="typeclasses-transparent-typclasses-opaque">
<span id="typeclassestransparent"></span><h3>Typeclasses Transparent, Typclasses Opaque<a class="headerlink" href="#typeclasses-transparent-typclasses-opaque" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="cmd">
<dt id="coq:cmd.typeclasses-transparent">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Transparent</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">+</span></span></span></code><a class="headerlink" href="#coq:cmd.typeclasses-transparent" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This command makes the identifiers transparent during typeclass
resolution.</p>
</dd></dl>

<dl class="cmd">
<dt id="coq:cmd.typeclasses-opaque">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Opaque</span> <span class="repeat-wrapper"><span class="repeat"><a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-ident"><span class="hole">ident</span></a></span><span class="notation-sup">+</span></span></span></code><a class="headerlink" href="#coq:cmd.typeclasses-opaque" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Make the identifiers opaque for typeclass search. It is useful when some
constants prevent some unifications and make resolution fail. It is also
useful to declare constants which should never be unfolded during
proof-search, like fixpoints or anything which does not look like an
abbreviation. This can additionally speed up proof search as the typeclass
map can be indexed by such rigid constants (see
<a class="reference internal" href="../proof-engine/tactics.html#thehintsdatabasesforautoandeauto"><span class="std std-ref">The hints databases for auto and eauto</span></a>).</p>
</dd></dl>

<p>By default, all constants and local variables are considered transparent. One
should take care not to make opaque any constant that is used to abbreviate a
type, like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>relation A := A -&gt; A -&gt; Prop.
</pre></div>
</div>
<p>This is equivalent to <code class="docutils literal notranslate"><span class="pre">Hint</span> <span class="pre">Transparent,</span> <span class="pre">Opaque</span> <span class="pre">ident</span> <span class="pre">:</span> <span class="pre">typeclass_instances</span></code>.</p>
</div>
<div class="section" id="options">
<h3>Options<a class="headerlink" href="#options" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="flag">
<dt id="coq:flag.typeclasses-dependency-order">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Dependency</span> <span>Order</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-dependency-order" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This option (on by default since 8.6) respects the dependency order
between subgoals, meaning that subgoals on which other subgoals depend
come first, while the non-dependent subgoals were put before
the dependent ones previously (Coq 8.5 and below). This can result in
quite different performance behaviors of proof search.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-filtered-unification">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Filtered</span> <span>Unification</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-filtered-unification" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This option, available since Coq 8.6 and off by default, switches the
hint application procedure to a filter-then-unify strategy. To apply a
hint, we first check that the goal <em>matches</em> syntactically the
inferred or specified pattern of the hint, and only then try to
<em>unify</em> the goal with the conclusion of the hint. This can drastically
improve performance by calling unification less often, matching
syntactic patterns being very quick. This also provides more control
on the triggering of instances. For example, forcing a constant to
explicitely appear in the pattern will make it never apply on a goal
where there is a hole in that place.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-limit-intros">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Limit</span> <span>Intros</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-limit-intros" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This option (on by default) controls the ability to apply hints while
avoiding (functional) eta-expansions in the generated proof term. It
does so by allowing hints that conclude in a product to apply to a
goal with a matching product directly, avoiding an introduction.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This can be expensive as it requires rebuilding hint
clauses dynamically, and does not benefit from the invertibility
status of the product introduction rule, resulting in potentially more
expensive proof-search (i.e. more useless backtracking).</p>
</div>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclass-resolution-for-conversion">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclass</span> <span>Resolution</span> <span>For</span> <span>Conversion</span></span></code><a class="headerlink" href="#coq:flag.typeclass-resolution-for-conversion" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This option (on by default) controls the use of typeclass resolution
when a unification problem cannot be solved during elaboration/type
inference. With this option on, when a unification fails, typeclass
resolution is tried before launching unification once again.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-strict-resolution">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Strict</span> <span>Resolution</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-strict-resolution" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Typeclass declarations introduced when this option is set have a
stricter resolution behavior (the option is off by default). When
looking for unifications of a goal with an instance of this class, we
“freeze” all the existentials appearing in the goals, meaning that
they are considered rigid during unification and cannot be
instantiated.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-unique-solutions">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Unique</span> <span>Solutions</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-unique-solutions" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>When a typeclass resolution is launched we ensure that it has a single
solution or fail. This ensures that the resolution is canonical, but
can make proof search much more expensive.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-unique-instances">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Unique</span> <span>Instances</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-unique-instances" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Typeclass declarations introduced when this option is set have a more
efficient resolution behavior (the option is off by default). When a
solution to the typeclass goal of this class is found, we never
backtrack on it, assuming that it is canonical.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.typeclasses-debug">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Debug</span></span></code><a class="headerlink" href="#coq:flag.typeclasses-debug" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Controls whether typeclass resolution steps are shown during search.  Setting this flag
also sets <a class="reference internal" href="#coq:opt.typeclasses-debug-verbosity" title="Typeclasses Debug Verbosity"><code class="xref coq coq-opt docutils literal notranslate"><span class="pre">Typeclasses</span> <span class="pre">Debug</span> <span class="pre">Verbosity</span></code></a> to 1.</p>
</dd></dl>

<dl class="opt">
<dt id="coq:opt.typeclasses-debug-verbosity">
<em class="property"><span class="sigannot">Option</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>Debug</span> <span>Verbosity</span> <a class="reference internal" href="../language/gallina-specification-language.html#grammar-token-num"><span class="hole">num</span></a></span></code><a class="headerlink" href="#coq:opt.typeclasses-debug-verbosity" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Determines how much information is shown for typeclass resolution steps during search.
1 is the default level.  2 shows additional information such as tried tactics and shelving
of goals.  Setting this option also sets <a class="reference internal" href="#coq:flag.typeclasses-debug" title="Typeclasses Debug"><code class="xref coq coq-flag docutils literal notranslate"><span class="pre">Typeclasses</span> <span class="pre">Debug</span></code></a>.</p>
</dd></dl>

<dl class="flag">
<dt id="coq:flag.refine-instance-mode">
<em class="property"><span class="sigannot">Flag</span></em> <code class="descname"><span class="notation"><span>Refine</span> <span>Instance</span> <span>Mode</span></span></code><a class="headerlink" href="#coq:flag.refine-instance-mode" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This option allows to switch the behavior of instance declarations made through
the Instance command.</p>
<ul class="simple">
<li>When it is on (the default), instances that have unsolved holes in
their proof-term silently open the proof mode with the remaining
obligations to prove.</li>
<li>When it is off, they fail with an error instead.</li>
</ul>
</dd></dl>

</div>
<div class="section" id="typeclasses-eauto">
<h3>Typeclasses eauto <cite>:=</cite><a class="headerlink" href="#typeclasses-eauto" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="cmd">
<dt id="coq:cmd.typeclasses-eauto">
<em class="property"><span class="sigannot">Command</span></em> <code class="descname"><span class="notation"><span>Typeclasses</span> <span>eauto</span> <span>:=</span> <span class="repeat-wrapper"><span class="repeat"><span>debug</span></span><span class="notation-sup">?</span></span> <span class="repeat-wrapper"><span class="repeat"><span class="curlies">{<span>dfs</span> <span>|</span> <span>bfs</span>}</span></span><span class="notation-sup">?</span></span> <span>depth</span></span></code><a class="headerlink" href="#coq:cmd.typeclasses-eauto" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>This command allows more global customization of the typeclass
resolution tactic. The semantics of the options are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">debug</span></code> In debug mode, the trace of successfully applied tactics is
printed.</li>
<li><code class="docutils literal notranslate"><span class="pre">dfs,</span> <span class="pre">bfs</span></code> This sets the search strategy to depth-first search (the
default) or breadth-first search.</li>
<li><code class="docutils literal notranslate"><span class="pre">depth</span></code> This sets the depth limit of the search.</li>
</ul>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="omega.html" class="btn btn-neutral float-right" title="Omega: a solver for quantifier-free problems in Presburger Arithmetic" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="canonical-structures.html" class="btn btn-neutral" title="Canonical Structures" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1999-2018, Inria.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'8.8.2',
            LANGUAGE:'ja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/notations.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>