

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Module System &mdash; Coq 8.8.2 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansi.css" type="text/css" />
  <link rel="stylesheet" href="../_static/coqdoc.css" type="text/css" />
  <link rel="stylesheet" href="../_static/notations.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pre-text.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="Vernacular commands" href="../proof-engine/vernacular-commands.html" />
    <link rel="prev" title="Calculus of Inductive Constructions" href="cic.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Coq
          

          
          </a>

          
            
            
              <div class="version">
                8.8.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">索引</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-cmdindex.html">Command index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-tacindex.html">Tactic index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-optindex.html">Flags, options and tables index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coq-exnindex.html">Errors and warnings index</a></li>
</ul>
<p class="caption"><span class="caption-text">はじめに</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>
<p class="caption"><span class="caption-text">言語</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gallina-specification-language.html">The Gallina specification language</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallina-extensions.html">Extensions of <span class="smallcaps">Gallina</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="coq-library.html">The <span class="smallcaps">Coq</span> library</a></li>
<li class="toctree-l1"><a class="reference internal" href="cic.html">Calculus of Inductive Constructions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Module System</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#modules-and-module-types">Modules and module types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#typing-modules">Typing Modules</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">証明エンジン</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/vernacular-commands.html">Vernacular commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/proof-handling.html">Proof handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/tactics.html">Tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ltac.html">The tactic language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/detailed-tactic-examples.html">Detailed examples of tactics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proof-engine/ssreflect-proof-language.html">The <span class="smallcaps">SSReflect</span> proof language</a></li>
</ul>
<p class="caption"><span class="caption-text">ユーザ拡張</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/syntax-extensions.html">Syntax extensions and interpretation scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-extensions/proof-schemes.html">Proof schemes</a></li>
</ul>
<p class="caption"><span class="caption-text">実用ツール</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coq-commands.html">The <span class="smallcaps">Coq</span> commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical-tools/coqide.html"><span class="smallcaps">Coq</span> Integrated Development Environment</a></li>
</ul>
<p class="caption"><span class="caption-text">付録</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../addendum/extended-pattern-matching.html">Extended pattern matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/implicit-coercions.html">Implicit Coercions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/canonical-structures.html">Canonical Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/type-classes.html">Type Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/omega.html">Omega: a solver for quantifier-free problems in Presburger Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/micromega.html">Micromega: tactics for solving arithmetic goals over ordered rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/extraction.html">Extraction of programs in <span class="smallcaps">OCaml</span> and Haskell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/program.html">Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/ring.html">The ring and field tactic families</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/nsatz.html">Nsatz: tactics for proving equalities in integral domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/generalized-rewriting.html">Generalized rewriting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/parallel-proof-processing.html">Asynchronous and Parallel Proof Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/miscellaneous-extensions.html">Miscellaneous extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addendum/universe-polymorphism.html">Polymorphic Universes</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zebibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Coq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>The Module System</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/coq/coq/blob/master/doc/sphinx/language/module-system.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="math-preamble math notranslate">
\[\begin{split}\newcommand{\alors}{\textsf{then}}
\newcommand{\alter}{\textsf{alter}}
\newcommand{\as}{\kw{as}}
\newcommand{\Assum}[3]{\kw{Assum}(#1)(#2:#3)}
\newcommand{\bool}{\textsf{bool}}
\newcommand{\case}{\kw{case}}
\newcommand{\conc}{\textsf{conc}}
\newcommand{\cons}{\textsf{cons}}
\newcommand{\consf}{\textsf{consf}}
\newcommand{\conshl}{\textsf{cons\_hl}}
\newcommand{\Def}[4]{\kw{Def}(#1)(#2:=#3:#4)}
\newcommand{\emptyf}{\textsf{emptyf}}
\newcommand{\End}{\kw{End}}
\newcommand{\kwend}{\kw{end}}
\newcommand{\EqSt}{\textsf{EqSt}}
\newcommand{\even}{\textsf{even}}
\newcommand{\evenO}{\textsf{even}_\textsf{O}}
\newcommand{\evenS}{\textsf{even}_\textsf{S}}
\newcommand{\false}{\textsf{false}}
\newcommand{\filter}{\textsf{filter}}
\newcommand{\Fix}{\kw{Fix}}
\newcommand{\fix}{\kw{fix}}
\newcommand{\for}{\textsf{for}}
\newcommand{\forest}{\textsf{forest}}
\newcommand{\from}{\textsf{from}}
\newcommand{\Functor}{\kw{Functor}}
\newcommand{\haslength}{\textsf{has\_length}}
\newcommand{\hd}{\textsf{hd}}
\newcommand{\ident}{\textsf{ident}}
\newcommand{\In}{\kw{in}}
\newcommand{\Ind}[4]{\kw{Ind}[#2](#3:=#4)}
\newcommand{\ind}[3]{\kw{Ind}~[#1]\left(#2\mathrm{~:=~}#3\right)}
\newcommand{\Indp}[5]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)}
\newcommand{\Indpstr}[6]{\kw{Ind}_{#5}(#1)[#2](#3:=#4)/{#6}}
\newcommand{\injective}{\kw{injective}}
\newcommand{\kw}[1]{\textsf{#1}}
\newcommand{\lb}{\lambda}
\newcommand{\length}{\textsf{length}}
\newcommand{\letin}[3]{\kw{let}~#1:=#2~\kw{in}~#3}
\newcommand{\List}{\textsf{list}}
\newcommand{\lra}{\longrightarrow}
\newcommand{\Match}{\kw{match}}
\newcommand{\Mod}[3]{{\kw{Mod}}({#1}:{#2}\,\zeroone{:={#3}})}
\newcommand{\ModA}[2]{{\kw{ModA}}({#1}=={#2})}
\newcommand{\ModS}[2]{{\kw{Mod}}({#1}:{#2})}
\newcommand{\ModType}[2]{{\kw{ModType}}({#1}:={#2})}
\newcommand{\mto}{.\;}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\nat}{\textsf{nat}}
\newcommand{\Nil}{\textsf{nil}}
\newcommand{\nilhl}{\textsf{nil\_hl}}
\newcommand{\nO}{\textsf{O}}
\newcommand{\node}{\textsf{node}}
\newcommand{\nS}{\textsf{S}}
\newcommand{\odd}{\textsf{odd}}
\newcommand{\oddS}{\textsf{odd}_\textsf{S}}
\newcommand{\ovl}[1]{\overline{#1}}
\newcommand{\Pair}{\textsf{pair}}
\newcommand{\Prod}{\textsf{prod}}
\newcommand{\Prop}{\textsf{Prop}}
\newcommand{\return}{\kw{return}}
\newcommand{\Set}{\textsf{Set}}
\newcommand{\si}{\textsf{if}}
\newcommand{\sinon}{\textsf{else}}
\newcommand{\Sort}{\cal S}
\newcommand{\Str}{\textsf{Stream}}
\newcommand{\Struct}{\kw{Struct}}
\newcommand{\subst}[3]{#1\{#2/#3\}}
\newcommand{\tl}{\textsf{tl}}
\newcommand{\tree}{\textsf{tree}}
\newcommand{\true}{\textsf{true}}
\newcommand{\Type}{\textsf{Type}}
\newcommand{\unfold}{\textsf{unfold}}
\newcommand{\WEV}[3]{\mbox{$#1[] \vdash #2 \lra  #3$}}
\newcommand{\WEVT}[3]{\mbox{$#1[] \vdash #2 \lra$}\\ \mbox{$ #3$}}
\newcommand{\WF}[2]{{\cal W\!F}(#1)[#2]}
\newcommand{\WFE}[1]{\WF{E}{#1}}
\newcommand{\WFT}[2]{#1[] \vdash {\cal W\!F}(#2)}
\newcommand{\WFTWOLINES}[2]{{\cal W\!F}\begin{array}{l}(#1)\\\mbox{}[{#2}]\end{array}}
\newcommand{\with}{\kw{with}}
\newcommand{\WS}[3]{#1[] \vdash #2 &lt;: #3}
\newcommand{\WSE}[2]{\WS{E}{#1}{#2}}
\newcommand{\WT}[4]{#1[#2] \vdash #3 : #4}
\newcommand{\WTE}[3]{\WT{E}{#1}{#2}{#3}}
\newcommand{\WTEG}[2]{\WTE{\Gamma}{#1}{#2}}
\newcommand{\WTM}[3]{\WT{#1}{}{#2}{#3}}
\newcommand{\zeroone}[1]{[{#1}]}
\newcommand{\zeros}{\textsf{zeros}}
\end{split}\]</div>
<div class="section" id="the-module-system">
<span id="themodulesystem"></span><h1>The Module System<a class="headerlink" href="#the-module-system" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>The module system extends the Calculus of Inductive Constructions
providing a convenient way to structure large developments as well as
a means of massive abstraction.</p>
<div class="section" id="modules-and-module-types">
<h2>Modules and module types<a class="headerlink" href="#modules-and-module-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><strong>Access path.</strong> An access path is denoted by <span class="math notranslate">\(p\)</span> and can be
either a module variable <span class="math notranslate">\(X\)</span> or, if <span class="math notranslate">\(p′\)</span> is an access path
and <span class="math notranslate">\(id\)</span> an identifier, then <span class="math notranslate">\(p′.id\)</span> is an access path.</p>
<p><strong>Structure element.</strong> A structure element is denoted by <span class="math notranslate">\(e\)</span> and
is either a definition of a constant, an assumption, a definition of
an inductive, a definition of a module, an alias of a module or a module
type abbreviation.</p>
<p><strong>Structure expression.</strong> A structure expression is denoted by <span class="math notranslate">\(S\)</span> and can be:</p>
<ul class="simple">
<li>an access path <span class="math notranslate">\(p\)</span></li>
<li>a plain structure <span class="math notranslate">\(\Struct~e ; … ; e~\End\)</span></li>
<li>a functor <span class="math notranslate">\(\Functor(X:S)~S′\)</span>, where <span class="math notranslate">\(X\)</span> is a module variable, <span class="math notranslate">\(S\)</span> and <span class="math notranslate">\(S′\)</span> are
structure expressions</li>
<li>an application <span class="math notranslate">\(S~p\)</span>, where <span class="math notranslate">\(S\)</span> is a structure expression and <span class="math notranslate">\(p\)</span> an
access path</li>
<li>a refined structure <span class="math notranslate">\(S~\with~p := p\)</span>′ or <span class="math notranslate">\(S~\with~p := t:T\)</span> where <span class="math notranslate">\(S\)</span> is a
structure expression, <span class="math notranslate">\(p\)</span> and <span class="math notranslate">\(p′\)</span> are access paths, <span class="math notranslate">\(t\)</span> is a term and <span class="math notranslate">\(T\)</span> is
the type of <span class="math notranslate">\(t\)</span>.</li>
</ul>
<p><strong>Module definition.</strong> A module definition is written <span class="math notranslate">\(\Mod{X}{S}{S'}\)</span>
and consists of a module variable <span class="math notranslate">\(X\)</span>, a module type
<span class="math notranslate">\(S\)</span> which can be any structure expression and optionally a
module implementation <span class="math notranslate">\(S′\)</span> which can be any structure expression
except a refined structure.</p>
<p><strong>Module alias.</strong> A module alias is written <span class="math notranslate">\(\ModA{X}{p}\)</span>
and consists of a module variable <span class="math notranslate">\(X\)</span> and a module path
<span class="math notranslate">\(p\)</span>.</p>
<p><strong>Module type abbreviation.</strong>
A module type abbreviation is written <span class="math notranslate">\(\ModType{Y}{S}\)</span>,
where <span class="math notranslate">\(Y\)</span> is an identifier and <span class="math notranslate">\(S\)</span> is any structure
expression .</p>
</div>
<div class="section" id="typing-modules">
<h2>Typing Modules<a class="headerlink" href="#typing-modules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>In order to introduce the typing system we first slightly extend the syntactic
class of terms and environments given in section <a class="reference internal" href="cic.html#the-terms"><span class="std std-ref">The terms</span></a>. The
environments, apart from definitions of constants and inductive types now also
hold any other structure elements. Terms, apart from variables, constants and
complex terms, include also access paths.</p>
<p>We also need additional typing judgments:</p>
<ul class="simple">
<li><span class="math notranslate">\(\WFT{E}{S}\)</span>, denoting that a structure <span class="math notranslate">\(S\)</span> is well-formed,</li>
<li><span class="math notranslate">\(\WTM{E}{p}{S}\)</span>, denoting that the module pointed by <span class="math notranslate">\(p\)</span> has type <span class="math notranslate">\(S\)</span> in
environment <span class="math notranslate">\(E\)</span>.</li>
<li><span class="math notranslate">\(\WEV{E}{S}{\ovl{S}}\)</span>, denoting that a structure <span class="math notranslate">\(S\)</span> is evaluated to a
structure <span class="math notranslate">\(S\)</span> in weak head normal form.</li>
<li><span class="math notranslate">\(\WS{E}{S_1}{S_2}\)</span> , denoting that a structure <span class="math notranslate">\(S_1\)</span> is a subtype of a
structure <span class="math notranslate">\(S_2\)</span>.</li>
<li><span class="math notranslate">\(\WS{E}{e_1}{e_2}\)</span> , denoting that a structure element e_1 is more
precise than a structure element e_2.</li>
</ul>
<p>The rules for forming structures are the following:</p>
<dl class="docutils">
<dt id="inference-wf-str">WF-STR<td><div class="first last math notranslate">
\[\frac{%
\WF{E;E′}{}%
}{%
\WFT{E}{ \Struct~E′ ~\End}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-wf-fun">WF-FUN<td><div class="first last math notranslate">
\[\frac{%
\WFT{E; \ModS{X}{S}}{ \ovl{S′} }%
}{%
\WFT{E}{ \Functor(X:S)~S′}%
}\]</div>
</td></dl>
<p>Evaluation of structures to weak head normal form:</p>
<dl class="docutils">
<dt id="inference-weval-app">WEVAL-APP<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S}{\Functor(X:S_1 )~S_2}~~~~~\WEV{E}{S_1}{\ovl{S_1}} \\%
\hspace{3em}%
\WTM{E}{p}{S_3}~~~~~ \WS{E}{S_3}{\ovl{S_1}}%
\hspace{3em}%
\end{array}%
}{%
\WEV{E}{S~p}{S_2 \{p/X,t_1 /p_1 .c_1 ,…,t_n /p_n.c_n \}}%
}\end{split}\]</div>
</td></dl>
<p>In the last rule, <span class="math notranslate">\(\{t_1 /p_1 .c_1 ,…,t_n /p_n .c_n \}\)</span> is the resulting
substitution from the inlining mechanism. We substitute in <span class="math notranslate">\(S\)</span> the
inlined fields <span class="math notranslate">\(p_i .c_i\)</span> from <span class="math notranslate">\(\ModS{X}{S_1 }\)</span> by the corresponding delta-
reduced term <span class="math notranslate">\(t_i\)</span> in <span class="math notranslate">\(p\)</span>.</p>
<dl class="docutils">
<dt id="inference-weval-with-mod">WEVAL-WITH-MOD<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
E[] ⊢ S \lra \Struct~e_1 ;…;e_i ; \ModS{X}{S_1 };e_{i+2} ;… ;e_n ~\End \\%
\hspace{3em}%
E;e_1 ;…;e_i [] ⊢ S_1 \lra \ovl{S_1} ~~~~~~%
\hspace{3em}%
E[] ⊢ p : S_2 \\%
\hspace{3em}%
E;e_1 ;…;e_i [] ⊢ S_2 &lt;: \ovl{S_1}%
\hspace{3em}%
\end{array}%
}{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S~\with~x := p}{}\\%
\hspace{3em}%
\Struct~e_1 ;…;e_i ; \ModA{X}{p};e_{i+2} \{p/X\} ;…;e_n \{p/X\} ~\End%
\hspace{3em}%
\end{array}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-with-mod-rec">WEVAL-WITH-MOD-REC<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S}{\Struct~e_1 ;…;e_i ; \ModS{X_1}{S_1 };e_{i+2} ;… ;e_n ~\End} \\%
\hspace{3em}%
\WEV{E;e_1 ;…;e_i }{S_1~\with~p := p_1}{\ovl{S_2}}%
\hspace{3em}%
\end{array}%
}{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S~\with~X_1.p := p_1}{} \\%
\hspace{3em}%
\Struct~e_1 ;…;e_i ; \ModS{X}{\ovl{S_2}};e_{i+2} \{p_1 /X_1.p\} ;…;e_n \{p_1 /X_1.p\} ~\End%
\hspace{3em}%
\end{array}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-with-def">WEVAL-WITH-DEF<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S}{\Struct~e_1 ;…;e_i ;\Assum{}{c}{T_1};e_{i+2} ;… ;e_n ~\End} \\%
\hspace{3em}%
\WS{E;e_1 ;…;e_i }{Def()(c:=t:T)}{\Assum{}{c}{T_1}}%
\hspace{3em}%
\end{array}%
}{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S~\with~c := t:T}{} \\%
\hspace{3em}%
\Struct~e_1 ;…;e_i ;Def()(c:=t:T);e_{i+2} ;… ;e_n ~\End%
\hspace{3em}%
\end{array}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-with-def-rec">WEVAL-WITH-DEF-REC<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S}{\Struct~e_1 ;…;e_i ; \ModS{X_1 }{S_1 };e_{i+2} ;… ;e_n ~\End} \\%
\hspace{3em}%
\WEV{E;e_1 ;…;e_i }{S_1~\with~p := p_1}{\ovl{S_2}}%
\hspace{3em}%
\end{array}%
}{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{S~\with~X_1.p := t:T}{} \\%
\hspace{3em}%
\Struct~e_1 ;…;e_i ; \ModS{X}{\ovl{S_2} };e_{i+2} ;… ;e_n ~\End%
\hspace{3em}%
\end{array}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-mod1">WEVAL-PATH-MOD1<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{p}{\Struct~e_1 ;…;e_i ; \Mod{X}{S}{S_1};e_{i+2} ;… ;e_n End} \\%
\hspace{3em}%
\WEV{E;e_1 ;…;e_i }{S}{\ovl{S}}%
\hspace{3em}%
\end{array}%
}{%
E[] ⊢ p.X \lra \ovl{S}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-mod2">WEVAL-PATH-MOD2<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
\Mod{X}{S}{S_1}∈ E%
\hspace{3em}%
\WEV{E}{S}{\ovl{S}}%
}{%
\WEV{E}{X}{\ovl{S}}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-alias1">WEVAL-PATH-ALIAS1<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{p}{~\Struct~e_1 ;…;e_i ; \ModA{X}{p_1};e_{i+2}  ;… ;e_n End} \\%
\hspace{3em}%
\WEV{E;e_1 ;…;e_i }{p_1}{\ovl{S}}%
\hspace{3em}%
\end{array}%
}{%
\WEV{E}{p.X}{\ovl{S}}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-alias2">WEVAL-PATH-ALIAS2<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
\ModA{X}{p_1 }∈ E%
\hspace{3em}%
\WEV{E}{p_1}{\ovl{S}}%
}{%
\WEV{E}{X}{\ovl{S}}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-type1">WEVAL-PATH-TYPE1<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WEV{E}{p}{~\Struct~e_1 ;…;e_i ; \ModType{Y}{S};e_{i+2} ;… ;e_n End} \\%
\hspace{3em}%
\WEV{E;e_1 ;…;e_i }{S}{\ovl{S}}%
\hspace{3em}%
\end{array}%
}{%
\WEV{E}{p.Y}{\ovl{S}}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-weval-path-type2">WEVAL-PATH-TYPE2<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
\ModType{Y}{S}∈ E%
\hspace{3em}%
\WEV{E}{S}{\ovl{S}}%
}{%
\WEV{E}{Y}{\ovl{S}}%
}\]</div>
</td></dl>
<p>Rules for typing module:</p>
<dl class="docutils">
<dt id="inference-mt-eval">MT-EVAL<td><div class="first last math notranslate">
\[\frac{%
\WEV{E}{p}{\ovl{S}}%
}{%
E[] ⊢ p : \ovl{S}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-mt-str">MT-STR<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p : S%
}{%
E[] ⊢ p : S/p%
}\]</div>
</td></dl>
<p>The last rule, called strengthening is used to make all module fields
manifestly equal to themselves. The notation <span class="math notranslate">\(S/p\)</span> has the following
meaning:</p>
<ul>
<li><p class="first">if <span class="math notranslate">\(S\lra~\Struct~e_1 ;…;e_n ~\End\)</span> then <span class="math notranslate">\(S/p=~\Struct~e_1 /p;…;e_n /p ~\End\)</span>
where <span class="math notranslate">\(e/p\)</span> is defined as follows (note that opaque definitions are processed
as assumptions):</p>
<blockquote>
<div><ul class="simple">
<li><span class="math notranslate">\(\Def{}{c}{t}{T}/p = \Def{}{c}{t}{T}\)</span></li>
<li><span class="math notranslate">\(\Assum{}{c}{U}/p = \Def{}{c}{p.c}{U}\)</span></li>
<li><span class="math notranslate">\(\ModS{X}{S}/p = \ModA{X}{p.X}\)</span></li>
<li><span class="math notranslate">\(\ModA{X}{p′}/p = \ModA{X}{p′}\)</span></li>
<li><span class="math notranslate">\(\Ind{}{Γ_P}{Γ_C}{Γ_I}/p = \Indp{}{Γ_P}{Γ_C}{Γ_I}{p}\)</span></li>
<li><span class="math notranslate">\(\Indpstr{}{Γ_P}{Γ_C}{Γ_I}{p'}{p} = \Indp{}{Γ_P}{Γ_C}{Γ_I}{p'}\)</span></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">if <span class="math notranslate">\(S \lra \Functor(X:S′)~S″\)</span> then <span class="math notranslate">\(S/p=S\)</span></p>
</li>
</ul>
<p>The notation <span class="math notranslate">\(\Indp{}{Γ_P}{Γ_C}{Γ_I}{p}\)</span>
denotes an inductive definition that is definitionally equal to the
inductive definition in the module denoted by the path <span class="math notranslate">\(p\)</span>. All rules
which have <span class="math notranslate">\(\Ind{}{Γ_P}{Γ_C}{Γ_I}\)</span> as premises are also valid for
<span class="math notranslate">\(\Indp{}{Γ_P}{Γ_C}{Γ_I}{p}\)</span>. We give the formation rule for
<span class="math notranslate">\(\Indp{}{Γ_P}{Γ_C}{Γ_I}{p}\)</span>
below as well as the equality rules on inductive types and
constructors.</p>
<p>The module subtyping rules:</p>
<dl class="docutils">
<dt id="inference-msub-str">MSUB-STR<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WS{E;e_1 ;…;e_n }{e_{σ(i)}}{e'_i ~\for~ i=1..m} \\%
\hspace{3em}%
σ : \{1… m\} → \{1… n\} ~\injective%
\hspace{3em}%
\end{array}%
}{%
\WS{E}{\Struct~e_1 ;…;e_n ~\End}{~\Struct~e'_1 ;…;e'_m ~\End}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-msub-fun">MSUB-FUN<td><div class="first last math notranslate">
\[\frac{%
\WS{E}{\ovl{S_1'}}{\ovl{S_1}}%
\hspace{3em}%
\WS{E; \ModS{X}{S_1'}}{\ovl{S_2}}{\ovl{S_2'}}%
}{%
E[] ⊢ \Functor(X:S_1 ) S_2 &lt;: \Functor(X:S_1') S_2'%
}\]</div>
</td></dl>
<p>Structure element subtyping rules:</p>
<dl class="docutils">
<dt id="inference-assum-assum">ASSUM-ASSUM<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ T_1 ≤_{βδιζη} T_2%
}{%
\WS{E}{\Assum{}{c}{T_1 }}{\Assum{}{c}{T_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-def-assum">DEF-ASSUM<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ T_1 ≤_{βδιζη} T_2%
}{%
\WS{E}{\Def{}{c}{t}{T_1 }}{\Assum{}{c}{T_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-assum-def">ASSUM-DEF<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ T_1 ≤_{βδιζη} T_2%
\hspace{3em}%
E[] ⊢ c =_{βδιζη} t_2%
}{%
\WS{E}{\Assum{}{c}{T_1 }}{\Def{}{c}{t_2 }{T_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-def-def">DEF-DEF<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ T_1 ≤_{βδιζη} T_2%
\hspace{3em}%
E[] ⊢ t_1 =_{βδιζη} t_2%
}{%
\WS{E}{\Def{}{c}{t_1 }{T_1 }}{\Def{}{c}{t_2 }{T_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-ind-ind">IND-IND<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ Γ_P =_{βδιζη} Γ_P'%
\hspace{3em}%
E[Γ_P ] ⊢ Γ_C =_{βδιζη} Γ_C'%
\hspace{3em}%
E[Γ_P ;Γ_C ] ⊢ Γ_I =_{βδιζη} Γ_I'%
}{%
\WS{E}{\ind{Γ_P}{Γ_C}{Γ_I}}{\ind{Γ_P'}{Γ_C'}{Γ_I'}}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-indp-ind">INDP-IND<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ Γ_P =_{βδιζη} Γ_P'%
\hspace{3em}%
E[Γ_P ] ⊢ Γ_C =_{βδιζη} Γ_C'%
\hspace{3em}%
E[Γ_P ;Γ_C ] ⊢ Γ_I =_{βδιζη} Γ_I'%
}{%
\WS{E}{\Indp{}{Γ_P}{Γ_C}{Γ_I}{p}}{\ind{Γ_P'}{Γ_C'}{Γ_I'}}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-indp-indp">INDP-INDP<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
E[] ⊢ Γ_P =_{βδιζη} Γ_P'%
\hspace{3em}%
E[Γ_P ] ⊢ Γ_C =_{βδιζη} Γ_C' \\%
\hspace{3em}%
E[Γ_P ;Γ_C ] ⊢ Γ_I =_{βδιζη} Γ_I'%
\hspace{3em}%
E[] ⊢ p =_{βδιζη} p'%
\hspace{3em}%
\end{array}%
}{%
\WS{E}{\Indp{}{Γ_P}{Γ_C}{Γ_I}{p}}{\Indp{}{Γ_P'}{Γ_C'}{Γ_I'}{p'}}%
}\end{split}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-mod-mod">MOD-MOD<td><div class="first last math notranslate">
\[\frac{%
\WS{E}{S_1}{S_2}%
}{%
\WS{E}{\ModS{X}{S_1 }}{\ModS{X}{S_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-alias-mod">ALIAS-MOD<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p : S_1%
\hspace{3em}%
\WS{E}{S_1}{S_2}%
}{%
\WS{E}{\ModA{X}{p}}{\ModS{X}{S_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-mod-alias">MOD-ALIAS<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p : S_2%
\hspace{3em}%
\WS{E}{S_1}{S_2}%
\hspace{3em}%
E[] ⊢ X =_{βδιζη} p%
}{%
\WS{E}{\ModS{X}{S_1 }}{\ModA{X}{p}}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-alias-alias">ALIAS-ALIAS<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p_1 =_{βδιζη} p_2%
}{%
\WS{E}{\ModA{X}{p_1 }}{\ModA{X}{p_2 }}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-modtype-modtype">MODTYPE-MODTYPE<td><div class="first last math notranslate">
\[\frac{%
\WS{E}{S_1}{S_2}%
\hspace{3em}%
\WS{E}{S_2}{S_1}%
}{%
\WS{E}{\ModType{Y}{S_1 }}{\ModType{Y}{S_2 }}%
}\]</div>
</td></dl>
<p>New environment formation rules</p>
<dl class="docutils">
<dt id="inference-wf-mod1">WF-MOD1<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
\WFT{E}{S}%
}{%
WF(E; \ModS{X}{S})[]%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-wf-mod2">WF-MOD2<td><div class="first last math notranslate">
\[\frac{%
\WS{E}{S_2}{S_1}%
\hspace{3em}%
\WF{E}{}%
\hspace{3em}%
\WFT{E}{S_1}%
\hspace{3em}%
\WFT{E}{S_2}%
}{%
\WF{E; \Mod{X}{S_1}{S_2}}{}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-wf-alias">WF-ALIAS<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
E[] ⊢ p : S%
}{%
\WF{E, \ModA{X}{p}}{}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-wf-modtype">WF-MODTYPE<td><div class="first last math notranslate">
\[\frac{%
\WF{E}{}%
\hspace{3em}%
\WFT{E}{S}%
}{%
\WF{E, \ModType{Y}{S}}{}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-wf-ind">WF-IND<td><div class="first last math notranslate">
\[\begin{split}\frac{%
\begin{array}{c}%
\hspace{3em}%
\WF{E;\ind{Γ_P}{Γ_C}{Γ_I}}{} \\%
\hspace{3em}%
E[] ⊢ p:~\Struct~e_1 ;…;e_n ;\ind{Γ_P'}{Γ_C'}{Γ_I'};… ~\End : \\%
\hspace{3em}%
E[] ⊢ \ind{Γ_P'}{Γ_C'}{Γ_I'} &lt;: \ind{Γ_P}{Γ_C}{Γ_I}%
\hspace{3em}%
\end{array}%
}{%
\WF{E; \Indp{}{Γ_P}{Γ_C}{Γ_I}{p} }{}%
}\end{split}\]</div>
</td></dl>
<p>Component access rules</p>
<dl class="docutils">
<dt id="inference-acc-type1">ACC-TYPE1<td><div class="first last math notranslate">
\[\frac{%
E[Γ] ⊢ p :~\Struct~e_1 ;…;e_i ;\Assum{}{c}{T};… ~\End%
}{%
E[Γ] ⊢ p.c : T%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-acc-type2">ACC-TYPE2<td><div class="first last math notranslate">
\[\frac{%
E[Γ] ⊢ p :~\Struct~e_1 ;…;e_i ;\Def{}{c}{t}{T};… ~\End%
}{%
E[Γ] ⊢ p.c : T%
}\]</div>
</td></dl>
<p>Notice that the following rule extends the delta rule defined in section <a class="reference internal" href="cic.html#conversion-rules"><span class="std std-ref">Conversion rules</span></a></p>
<dl class="docutils">
<dt id="inference-acc-delta">ACC-DELTA<td><div class="first last math notranslate">
\[\frac{%
E[Γ] ⊢ p :~\Struct~e_1 ;…;e_i ;\Def{}{c}{t}{U};… ~\End%
}{%
E[Γ] ⊢ p.c \triangleright_δ t%
}\]</div>
</td></dl>
<p>In the rules below we assume
<span class="math notranslate">\(Γ_P\)</span> is <span class="math notranslate">\([p_1 :P_1 ;…;p_r :P_r ]\)</span>,
<span class="math notranslate">\(Γ_I\)</span> is <span class="math notranslate">\([I_1 :A_1 ;…;I_k :A_k ]\)</span>,
and <span class="math notranslate">\(Γ_C\)</span> is <span class="math notranslate">\([c_1 :C_1 ;…;c_n :C_n ]\)</span>.</p>
<dl class="docutils">
<dt id="inference-acc-ind1">ACC-IND1<td><div class="first last math notranslate">
\[\frac{%
E[Γ] ⊢ p :~\Struct~e_1 ;…;e_i ;\ind{Γ_P}{Γ_C}{Γ_I};… ~\End%
}{%
E[Γ] ⊢ p.I_j : (p_1 :P_1 )…(p_r :P_r )A_j%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-acc-ind2">ACC-IND2<td><div class="first last math notranslate">
\[\frac{%
E[Γ] ⊢ p :~\Struct~e_1 ;…;e_i ;\ind{Γ_P}{Γ_C}{Γ_I};… ~\End%
}{%
E[Γ] ⊢ p.c_m : (p_1 :P_1 )…(p_r :P_r )C_m I_j (I_j~p_1 …p_r )_{j=1… k}%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-acc-indp1">ACC-INDP1<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p :~\Struct~e_1 ;…;e_i ; \Indp{}{Γ_P}{Γ_C}{Γ_I}{p'} ;… ~\End%
}{%
E[] ⊢ p.I_i \triangleright_δ p'.I_i%
}\]</div>
</td></dl>
<dl class="docutils">
<dt id="inference-acc-indp2">ACC-INDP2<td><div class="first last math notranslate">
\[\frac{%
E[] ⊢ p :~\Struct~e_1 ;…;e_i ; \Indp{}{Γ_P}{Γ_C}{Γ_I}{p'} ;… ~\End%
}{%
E[] ⊢ p.c_i \triangleright_δ p'.c_i%
}\]</div>
</td></dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../proof-engine/vernacular-commands.html" class="btn btn-neutral float-right" title="Vernacular commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cic.html" class="btn btn-neutral" title="Calculus of Inductive Constructions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1999-2018, Inria.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'8.8.2',
            LANGUAGE:'ja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/notations.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>